[{"content":"Her kommer vi løpende med korte tips og tricks man kan gjøre for å øke sin sikkerhetshygiene. Målet er å komme med nye tips hver dag i hele Oktober!\n1 Oktober - Nettleser kontroll En ting vi har sett mye av de siste årene har vært sårbarheter tilknyttet nettleseren. Dette er litt fordi at nettleseren er kontinuerlig under utvikling, nye web standarder som skal supporteres, nye funksjonalitet med add-ons og ikke minst skal bli tettere integrert med det underliggende operativsystemet for å kunne understøtte nye tjenester som WebRTC, WebGL, QUIC/HTTP3.\nNettleseren er også mye av hovedverktøyet til alle ansatte å må derfor viktig angrepsflate som må beskyttes. Så langt i år har Google Chrome hatt 13 (0-dags) sårbarheter med noen av disse har også blitt utnyttet for å gjennomføre angrep. Vi har også sett eksempler på hvor extensions som har hatt over 20 millioner brukere som har blitt brukt for innsamling av informasjon eller videresende brukere til phising nettsider. Så det er veldig viktig å ha kontroll på nettleseren i forhold til å ha oppdateringer automatisk samt kontroll på addons samt noen andre justeringer.\nFor Administrerte klienter kan dette styres via Group Policy som kan lastes ned her \u0026ndash;\u0026gt; https://enterprise.google.com/chrome/chrome-browser/#download samt det finnes en egen Group Policy for styring av oppdateringer (https://dl.google.com/update2/enterprise/googleupdateadmx.zip)\nHer er det en rekke innstillinger man bør definere\n Google Chrome \u0026ndash;\u0026gt; Extensions \u0026ndash;\u0026gt; Blocks external extensions from being installed Google Chrome \u0026ndash;\u0026gt; Extensions \u0026ndash;\u0026gt; Configure extension installation blocklist (med verdi *) dette forhindrer at extensions blir innstallert med mindre de ligger i allow listen. Google Chrome \u0026ndash;\u0026gt; Set the time peroid for update notifications \u0026ndash;\u0026gt; Når brukere får beskjed om at Chrome må restarte pga oppdateringer vil verdien man definere her gjør at Chrome blir automatisk restartet. Google Chrome \u0026ndash;\u0026gt; Notify a user that a browser relaunch or device restart is recommended or required \u0026ndash;\u0026gt; Show a recurring prompt to the user indicating that a restart is required. Google \u0026ndash;\u0026gt; Google Update \u0026ndash;\u0026gt; Applications. Always Allow Updates (recommended) Google \u0026ndash;\u0026gt; Google Update \u0026ndash;\u0026gt; Application \u0026ndash;\u0026gt; Google Chrome. Always Allow Updates (recommended)  4 Oktober - Har du kontroll på DNS? Hver eneste dag er det tusenvis av nye domener som blir registrerte hos ulike DNS registrarer. Majoriteten av disse nye domenene som blir opprettet er for mistenkelige formål, som enten brukes til phising angrep eller for andre formål.\nRef: https://unit42.paloaltonetworks.com/newly-registered-domains-malicious-abuse-by-bad-actors/\nMange domener har også kort levetid som ofte henger sammen med en phising kampanje som kjøres for å lure brukere mot f.eks. nettsider som skal imitere nettbanker, sosiale medier eller andre kjente nettsider for å få brukere til å oppgi sensitiv informasjon som brukernavn og passord.\nDet er selvsagt veldig vanskelig å få blokkert alle domener som mulig blir opprettet en gang i fremtiden eller som er av mistenkelig art.\nDe fleste brannmurer har mulighet for å blokkere slike såkalte NSD (Newly Seen Domains) slik at de gjør et oppslag først mot den aktuelle WHOIS infoen for å se levetiden på domenet. Dette er derimot litt mer utfordrende når man sitter på hjemme nett eller andre lokasjoner hvor trafikken ikke går igjennom en sentral brannmur tjeneste. Det finnes derimot gratis tjeneste som kan automatisk blokkere både mot NSD samt domener som er av mistenkelig art.\nBlant annet er det f.eks. Cloudflare og Cisco som begge tilbyr en gratis utgave av DNS tjenestene sine.\n Cloudflare: https://developers.cloudflare.com/1.1.1.1/1.1.1.1-for-families OpenDNS (Cisco): https://support.opendns.com/hc/en-us/articles/227988127-Getting-started-About-using-OpenDNS  Ellers så har også begge leverandører en kommersiell modell som kan brukes for organisasjoner. Fordelen med en slik DNS-tjeneste kontra andre er også at man får en desentralisert DNS tjeneste som vil virke uavhengig hvor brukeren/enheten befinner seg. Samt at begge leverandørene er også de som leverer de raskeste DNS tjenesten.\nEksempelvis:\nSamtidig tilbyr også begge leverandørene DoH (DNS over HTTPS) som gjør at man kan gjøre DNS oppslag kryptert også. Slik at DNS trafikk også er kryptert for nettleseren. Merk at dette krever at nettleser eller det er innebygget funksjonalitet i operativsystemet. Som det blir nå med Windows 11 blant annet, mens de fleste nettleseren har støtte for det allerede. Men merk at sistnevnte kun gir krypert DNS oppslag for nettleser trafikk å ikke for alt annet av tjeneste kommunikasjon.\nHar du noen tips til andre innstilliger man bør ha med? gi oss beskjed! marius@trusselsky.no\n","permalink":"https://trusselsky.github.io/secokt/","summary":"Her kommer vi løpende med korte tips og tricks man kan gjøre for å øke sin sikkerhetshygiene. Målet er å komme med nye tips hver dag i hele Oktober!\n1 Oktober - Nettleser kontroll En ting vi har sett mye av de siste årene har vært sårbarheter tilknyttet nettleseren. Dette er litt fordi at nettleseren er kontinuerlig under utvikling, nye web standarder som skal supporteres, nye funksjonalitet med add-ons og ikke minst skal bli tettere integrert med det underliggende operativsystemet for å kunne understøtte nye tjenester som WebRTC, WebGL, QUIC/HTTP3.","title":"Sikkerhetsmåneden Oktober"},{"content":"Microsoft lanserte nylig at man kunne begynne å logge inn mot Microsoft-kontoen uten passord men heller benytte seg av Microsoft authenticator appen (eller andre mekanismer som f.eks fysiske adgangsnøkler) for innlogging.\nFunksjonen er ikke ny, men har primært vært tilgjenglig for bedriftsmarkedet frem til nå. Alikevel er det ikke mange som har benyttet seg av funksjonaliteten, derfor ønsket vi å belyse litt hvordan tjenesten fungerer. Litt om hva som behøves, hva som er supportert og hvorfor det er sikrere en vanlig brukernavn og passord. Samt litt om økosystemet rundt å hvem som supporterer denne autentiseringsmekanismen.\nFIDO2 FIDO (Fast IDentity Online) alliasen er en rekke organisasjoner som samarbeider ved å utvikle en sikrere og enklere måter å autentisere på. Denne gruppen kom med FIDO2 standarden som var et utvidelse av det eksisterende rammeverket som de hadde laget men skulle tilby sikker autentisering basert på passordløs autentisering både for mobile og vanlige arbeidsstasjoner.\nFIDO2 Består av to standard hoved komponenter\n Et Web API (WebAuthn) Client Authentication Protocol (CTAP) CTAP definerer protokollen for en ekstern sikkerhetsnøkkel og snakker med en klientenhet. Begge disse er tett ingrert å leverer med det en passordløs pålogging mekanisme.  For å kunne benytte seg av FIDO2 standarden er man avhengig av å ha støtte for WebAuth og CTAP protokollen på underliggende systemer som f.eks identitetstjenesten, nettleseren og ikke minst operativsystemet for å kunne håndtere autentiseringsmekanismen. Så hvem støtter FIDO2 standarden?\nDe fleste moderne nettlesere støtter FIDO2 standarden mot Azure Active Directory med ulike CTAP støtte som USB, NFC eller Bluetooth (BLE)\nI tillegg må man ha FIDO2 godkjente sikkerhetsnøkler fra en supportert leverandør. Som disse leverandørene her som tilbyr en rekke sikkerhetsnøkler som kommer med ulike funksjonalitet som f.eks Yubiko som leverer USB/NFC nøkler med touch-basert autentisering. Men de fleste leverandørene har ulike alternativer basert på ulik USB(A/C) format\n Feitian Kensington Thales Thetis Token2 Switzerland TrustKey Solutions Yubico  Hva støtter FIDO2? Men hvilken identitetstjenester støtter FIDO2? (Ikke en helt fullstendig liste)\n Google Identity Azure Active Directory (omfatter og Office 365) Okta Github Buypass ID \u0026amp; Authentication tjenesten (https://buypassdev.atlassian.net/wiki/spaces/BFIS/overview) PingIdentity Sosial medier som (Facebook/Twitter) Passordtjenester som (1Password, LastPass f.eks)  Det finnes også en fullstendig liste som spesielt Yubikey støtter her \u0026ndash;\u0026gt; https://www.yubico.com/no/works-with-yubikey/catalog/?sort=popular\nSelv om ikke alle applikasjoner har innebygget støtte for WebAuth så vil det fungere om applikasjoner og tjenester man benytter seg av er integert mot en av disse identitetstjenestene over som (f.eks AzureAD), betyr det at man kan benytte seg av f.eks passordløs autentisering mot disse tjenestene.\nFra en sluttbruker perspektiv som skal autentisere mot en angitt tjeneste, vil arbeidsflyten være slik.(NB WebAuth er et javascript biblotek som kjører i nettleseren)\n 0: Bruker går mot angitt applikasjon som krever autentisering, går tilbake til iDP. 1: Relay party (som er en komponent hos iDPen) sender 2: Nettleseren sender en authenticatorMakeCredential() som inneholder til authenticator (via CTAP) tjenesten å be brukeren legge inn enten pinkode eller touch 3: Brukeren verifiserer autentiseringen tilbake til CTAP. 4: CTAP returnerer data tilbake til nettleseren med en ny credential ID og annen informasjon 5: Nettleseren sender data tilbake til server (Relay party hos iDPen) 6: Server godkjenner forespørselen å sender tilbake et access token fra iDPen som gir SSO.  Hvordan sette opp en passordløs løsning med Yubikey? Oppskriften her er å sette opp dette mot Azure Active Directory. Hvor det første steget er å aktivere FIDO2 som en påloggingsmekanisme i Azure AD. Dette gjøres under Azure AD Properties \u0026ndash;\u0026gt; Security \u0026ndash;\u0026gt; Authentication Methods. Deretter må FODI2 aktiveres.\n Når dette er gjort, men per bruker aktivere nøkkelen for sin bruker. Dette kan gjøres via myapps.microsoft.com å under Security og Sign-ins velge Security information og velge \u0026ldquo;Add Method\u0026rdquo;. Under der vil man ha valg om å legge til Security Key.   å deretter velge hva slags type nøkkel man har. I eksempelt her har jeg en Yubikey v4 som kun er støtte via USB.   Når man velger nøkkeltype, vil iDP tjenesten trigger autentiseringsflyten via WebAuthn som vil kjøre registrering av nøkkelen. Så vil man se en typisk bilde som dette for å registrere nøkkelen sin.   Når dette er gjort, vil man også avhengig av type nøkkel fullføre en autentiseringsprosess enten ved å legge inn pinkode eller touch basert autentisering   Når dette er gjort vil man via Azure AD login som dekker O365 og andre tjenester ha \u0026ldquo;Sign in with a Security Key\u0026rdquo; som opsjon. Pinkode i tilfelle ved logging vil være andre faktoren som oppfyller kravene til MFA.   Det skal også sies at samme autenseringsmekanisme er også tilgjengelig direkte mot Windows. Som krever at Windows Hello For Business er aktivert. I prinsippet så har Microsoft integert CTAP komponenten inn i sitt operativsystem for å få til dette. Om klienten også er en del av Azure AD vil man også kunne få SSO fra Windows login ut til alle tjenester som er integrert mot iDP tjenesten.  Hensyn man må ta om man setter dette opp for Windows infrastruktur Så langt har vi beskrevet oppsettet inn mot en skybasert identitestjeneste, kan dette også virke mot mer tradisjonelle tjenester som Active Directory? Det er også supportert men krever noe modifikasjoner mot Active Directory som beskrives her \u0026ndash;\u0026gt; https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-authentication-passwordless-security-key-on-premises (men merk det krever fortsatt at man har identitet synkronisert ut mot Azure Active Directory)\nMen det er viktig å påpeke at denne tjenester er ikke supportert mot alle protokoller som f.eks RDP eller \u0026ldquo;Run-as\u0026rdquo; eller pålogging mot servere via WMI/PowerShell.\nEr vi tryggere nå? Er man tryggere når en bruker ikke lengre vet sitt eget passord? Om en bruker ikke lengre har tilgang til sitt eget passord betyr det også at man ikke kan oppgi denne type informasjon som også gjør at man blir mindre sårbar for brukerinformasjon som er på avveie. Alikevel vil ikke f.eks implementering av slike løsniger forhindre at brukernavn og passord kan komme på avveie alikevel. Selv om brukeren bruker en FIDO2 basert nøkkel for passordløs autensering så sitter fortsatt passordet lagret hos identitetstjenesten. Eneste måten man da kan forhindre det på er om idenditetsleverandøren tar bort passordet helt fra løsningen, slik som Microsoft har gjort som mulighet for Microsoft online kontoer.\nSamtidig har man også mulighet til å definere sikkerhetsregler som krever f.eks at om man skal kunne logge inn så må man ha nøkkelen for å gjennomføre MFA autentiseringen.\nOm den også skal ha ønsket effektv ved å eliminere passord, må man også se på resten av økosystemet. Hva slags tjenester er det som brukeren har behov/tilgang til som krever passord? mobilen? print systemet? adgangskontroll? Det er selvsagt viktig å vurdere hvordan og hvilken type løsning som passer til det økosystemet man har for å kunne få til en sømløs opplevelse for brukerene.\n","permalink":"https://trusselsky.github.io/posts/kommeigangmedpassordl%C3%B8s/","summary":"Microsoft lanserte nylig at man kunne begynne å logge inn mot Microsoft-kontoen uten passord men heller benytte seg av Microsoft authenticator appen (eller andre mekanismer som f.eks fysiske adgangsnøkler) for innlogging.\nFunksjonen er ikke ny, men har primært vært tilgjenglig for bedriftsmarkedet frem til nå. Alikevel er det ikke mange som har benyttet seg av funksjonaliteten, derfor ønsket vi å belyse litt hvordan tjenesten fungerer. Litt om hva som behøves, hva som er supportert og hvorfor det er sikrere en vanlig brukernavn og passord.","title":"Hvordan komme til en passordløs hverdag?"},{"content":"De siste månedene har det vært en voldsom økning knyttet til ransomware angrep, derfor ønsket vi å komme med en den generelle råd i forhold til hvordan man kan redusere risikoen for å bli utsatt for ransomware angrep. NB: Dette er en liste med tiltak som vil bli kontinuerlig oppdatert (19/09/2021)\nDet er viktig å påpeke at ransomware angrep har i det siste også vært mye tidligere ute med å ta i bruk nye sårbarheter. Dette betyr at viktigheten med å få på plass sikkerhetsoppdateringer er essensielt.\nAngrepsvinklene De siste årene har ransomware aktørene endret taktikk i forhold til hvordan ransomware angrep blir gjennomført. Ransomware angrep forekommer ofte i to ulike varianter.\nDDoS Ransomware angrep som omhandler at en organisasjon blir utsatt for distribuert angrep mot eksterne tjenester eller mot datasenteret med ofte veldig store mengder data som gjør det vanskelig å håndtere. Senest i sommer kom det frem at en organisasjon ble utsatt for en DDoS angrep som ble målt opp til 17 millioner forespørsler per sekund. Når disse angrepene forekommer vil ofte de som fasiliterer angrepet sende epost til IT-kontaktene i organisasjonen å deretter be om løsepenger eller så vil angrepet øke i omfang og lengde.\nKryptering ransomware angrep som omhandler at en organisasjon blir utsatt for angrep hvor hackerene ofte vil gjøre data utilgjengelig ved å kryptere informasjon/data de har tilgang til. Dette er den vanligste angrepsformen, men vi ser nå i det siste så har også hackerene endret taktikk til at det også gjør flere ting for å øke sannsynligheten for at løsepenger blir betalt.\n Henter ut data og lagrer på sine egne servere og deretter kjører omvendt auksjon - ergo organisasjonen må by på sine egne filer og data eller så blir informasjon publisert ut mot internett Truer med å kontakte media, samarbeidspartnere eller sluttkunder av organisasjonen. Om de har sensitive opplysninger om enkeltpersoner eller andre foretak som de har tilgang til vil de også bruke dette for å eventuelt true disse individene også.  Denne angrepsformen er ofte gjennomført eller starter via\n Phising angrep mot sluttbrukere Feilkonfigurert infrastruktur (som f.eks tjenester som er eksponert ut mot Internet uten noen sikkerhetsmekanismer) Sårbarheter Gjenbruk av identitet  Når en eventuelt hacker har fått tilgang til en kompromitert klient eller via en sårbar tjenester så vil de benytte ulike mekanismer for å komme lengre innover i infrastrukturen. Veldig ofte hvor hackere har greid å gjennomføre angrep hvor de tilslutt har greid å gjøre all infrastruktur utilgjengelig er det ofte enkle ting som har vært den utløsende faktoren. Ofte ser vi at det er tjenester som er sårbare hvor leverandøren har hatt sikkerhetsoppdatering tilgjengelig lenge eller bare dårlig sikkerhetshygine, eller en kombinasjon av begge deler.\nTiltak Her vil vi gå overordent igjennom en del tiltak som man bør ha gjennomført for å redusere risikoen tilknyttet ransomware. Et viktig element som er viktig å forstå er at ransomware utnytter i prinsippet alltid de svakeste leddene i en IT infrastruktur så derfor er det viktig å ha kontinuerlig forbedringer og jobbe systematisk med sikkerhet.\nIdentitet  Definere en strengere passord policy som angir at passord bør være melom 15 - 20 bokstaver som ikke bør inneholde ord som kommer fra typisk ordbok som gjør at det man være enkelt å kjøre brute-force angrep. Samtidig bør også varigheten på settes til at den ikke utløper eller så lenge som mulig. Det er derimot viktigere å ha MFA mekanismer på toppen. Tjenester som Azure AD Password Protection kan brukes for unngå at noen bruker standard ord som en del av passordene sine. Definere MFA for all tilgang. Tjeneste som Windows Hello for Business, eller tjenester som støtter SAML/OAuth bør brukes for tjenester for å kunne gi MFA kombinert med SSO for tilgang til tjenester. SAML/Oauth bør også brukes for å etablere integrasjoner mot andre SaaS tjenester slik at man så få brukerkontoer som mulig fra en brukerkontekst. Bruk tjenester som Azure AD Identity Protection, Haveibeenpwnd.com eller f-secure identity protection for å overvåkning på sluttbrukerens identitet. Disse tjenestene kan gi indikasjon på om bruker informasjon er på avveie eller brukerkontoer har blitt kompromitert via en hacket 3.parts tjeneste. Om man har Azure AD Connect sett på password hash sync (om det ikke er aktivert) dette vil også gjøre at Microsoft kan sammenligne hash med informasjon som sikkerhetsforskerene der finner på kompromiterte 3.parts sider å kan informere om bruker informasjon er på avveie.  Sårbarheter  Sårbarheter er noe som blir funnet kontinuerlig, enten det er da sårbarheter i kjente produkter som Windows eller om det er sårbarheter tilknyttet egenutviklet tjenester. Ofte handler det om å ha automatisert oppdateringsmekanismer på plass som en sentralisert. Ofte er dette f.eks WSUS for Windows infrastruktur eller Windows Update for Business for klient via Intune eller Red Hat Satellite for Linux infrastruktur. Men utfordringen er 3.parts tjenester som ikke blir dekket av de sentralisrte patchesystemene. Da må man enten benytte 3.parts tjenester som Qualys eller Rapid7 produkter for å få kontinuerlig informasjon om sårbarheter. Eller at man må kontinuerlig overvåke applikasjonslandskapet å følge med på sikkerhetspatcher som kommer fra leverandørene. Man kan også se her for en kompilert liste over standard sårbarheter ransomware aktører har utnyttet de siste årene \u0026ndash;\u0026gt; https://www.bleepingcomputer.com/news/security/researchers-compile-list-of-vulnerabilities-abused-by-ransomware-gangs/  Nettverk  Forsikre dere om at ingen unødvendige tjenester er eksponert ut. Mange ransomware angrep starter som oftest av maskiner som blir kompromiterte som er feil konfigurert som f.eks en Windows Server med RDP som er aktiv. For tjenester som er eksponert pass på at kun godkjente tjenester er tilgjengelige, slik at tjenester som f.eks SMB (filtrafikk) er tilgjengelig ut mot Internett. Om tjenester som RDP skal være tilgjengelig eksternt må det være MFA tjenester på plass. Om man driver med ecommerence eller nettshop løsning, se på desentralisert brannmur tjenester for å forhindre at DDoS trafikk blir rutet mot eget datasenter eller mot hosting leverandør.  Klienter  Definere en standard Group Policy for hvilken standard applikasjoner som skal brukes for åpning av filer som HTA, JS eller lignende. Norsk Helsenett har definert en standard liste som er grei å følge \u0026ndash;\u0026gt; https://www.nhn.no/Personvern-og-informasjonssikkerhet/helsecert/anbefalte-sikkerhetstiltak/blokkering-av-script-og-programfiler Macroer tilknyttet Microsoft Office bør deaktiveres eller begrenset kun til å kjøre fra godkjente lokasjoner. Finnes også en rekke tiltak her som bør følges \u0026ndash;\u0026gt; https://adsecurity.org/?p=3299 Benytt tjenester som Identity Guard (Benyttes for å forhindre lesetilgang til LSASS som typisk brukes for å hente ut lokal brukerdatabase) Application Guard (Gjør at tjenester som Microsoft Edge, Office kan kjøres i en egen container som er isolert fra resten av operativsystemet) Fjern at brukeren kjører som lokal administrator, ha eleveringsmulighet med f.eks bruk av https://github.com/pseymour/MakeMeAdmin/wiki Forsikre seg om at tjenester som antivirus og (eventuelt EDR) tjenester er innstallert og oppdatert på alle klienter. (Her er en god oversikt på gode antivirus leverandører \u0026ndash;\u0026gt; https://www.av-comparatives.org/tests/real-world-protection-test-july-august-2021-factsheet/) Om man bruker Microsoft Edge eller Google Chrome ha Password Monitoring aktivert i nettleseren. Ha regelsett på plass for nettleseren via Group Policy for å forhindre at det ikke er tillatt å surfe på nettsider med et self-signed sertifikat. Samt verifisere at Safe Browsing og Smartscreen filter er aktivert. Tilby login via bruk av tjenester som Windows Hello for Business eller tjenester som støtter WebAuth ved login som gjør at man kan logge inn med bruk av f.eks hardware nøkler som Yubikey. Ha utvidelser eller extensions som blokkerer pop-ups. Flytt klienten ut av Active Directory og ut til Azure Active Directory. All ransomware kode som er laget i dag som tar utgangspunkt i en kompromitert klient er laget for å deretter bevege seg videre innover i infrastrukturen via Active Directory. Ved å flytte klienten ut til Azure AD tar man i prinsippet bort denne muligheten. Det samme prinsippet gjelder for Chromebooks/tynnklienten hvor det er liten til null sjans for å kompromitere endepunktet. Bruk Attack Surface Reduction rules til å aktivere regelsett mot at Microsoft Office skal få lov til å starte \u0026ldquo;child processes\u0026rdquo; som var utnyttet i forbindelse med siste MSHTML sårbarhet. Deaktiver autorun Eventuell tilgang til sentrale tjenester bør følge et zero-trust prinsipp. Hvor ihvertfall bruker og enhets kontekst bør evalueres før tilgang gis. Som f.eks via Conditional Access.  Epost  Forhindre mottak av filer med spesifkke filtyper. (https://docs.microsoft.com/en-us/exchange/troubleshoot/email-delivery/how-to-block-message-from-being-sent-or-received)  Windows Infrastruktur  Slå av bruk av eldre versjoner av SMB fil protokollen. Mange har oppgraderte Windows fil servere som i mange sammenhenger fortsatt har eldre versjoner av SMB som har en del sårbarheter. Disse bør skrus av/deaktivere å man bør passe på at kun SMB 3 er mulig å bruke. Aktiver SMB Signing - Dette gjøres via Group Policy Avinnstaller eldre versjoner av PowerShell. PowerShell kan ha flere versjoner innstallert samtidig. Mange Ransomware script prøver å kjøre via PoewrShell v1 pga mangel av logging og sikkerhetsmekanismer. Verifiser at siste versjon er tilgjengelig på Windows Servere. Det bør ihvertfall være fra versjon 5 og oppover innstallert. Forsikre også at PowerShell har script block aktivert, samt transaksjons logging slik at man kan logge all bruk av PowerShell. Innstallere Windows LAPS (Local Administrator Password Solution) dette for å automatisk rotere lokal administrator passord på maskinene. Definer Group Policy for å skru på \u0026ldquo;Deny log on trough Remote Desktop Services\u0026rdquo; Mange ransomware aktører benytter RDP for å logge på andre servere i infrastrukturen, ved å angi denne group policyen kan man begrense hvilken kontoer som får lov til å logge på miljøet. Slå av Widows tjenester som ikke skal brukes på aktuelle servere. Som f.eks domene kontrollere har ikke behov for Print Spooler tjenesten å bør skrus av der. Om man benytter noen provisjoneringstjeneste for enten Citrix eller templates for VMware, er det viktig å ha en rutine på plass for å huske å oppdatere image jevnlig med de siste sikkerhetsoppdateringene. Unngå helst bruk av tradisjonell RDP som managmenet løsning, men om det kreves bruk ihvertfall Remote Credential Guard for å unngå eventuelle pash-the-hash angrep. Eller bruk av Protected Privileged Accounts som krever domene nivå satt til 2012 R2 men forhindrer at man kan logge inn med NTLM eller delegert tilgang. Sett antall cached credentials til null (med mindre det er et Citrix miljø)  Skytjenester  For SharePoint/Onedrive definer policier hvor man angir godkjente filtyper som kan synkroniseres via OneDrive. (Set-SPOTenantSyncClientRestriction -ExcludedFileExtensions « exe;js;hts\u0026quot;) Ha Conditional Access regelsett på plass som deaktiverer legacy protokoller i Azure AD.  Generelle tiltak  Backup tjenesten bør være frakoblet fra virtuell infrastruktur samt Active Directory. I mange sammenhenger har vi sett at backup data har blitt kryptert sammen med resten av infrastrukturen. Man bør redusere risikoen for at backupen blir infisert derfør bør backup løsningen kjøre isolert med egne brukeridentitet. Følge 3-2-1 reglene i forhold til backup. At man har 3 kopier av data (produksjonsdata samt 2 backup kopier) på 2 ulike medier samt med en kopi offiste. Verifiser backup dataene ofte, har rutiner på plass. Samt at flere backup levernadører kan nå tilby automatisert sjekk av data som bør settes opp som en automatisert jobb. Bruk immutable backup data om mulig. Dette forhindrer at ransomware aktører kan overskrive backup data (ved å f.eks kryptere innholdet) men krever at man har en backup leverandør som supporterer dette. Eksterne web-tjenester hvor man er usikker på angrepsflaten bør plasseres bak en WAF (Web Application Firewall) tjeneste.  Data og informasjon  Se på mulighet for kryptering av sensitiv data. F.eks filer som databaser eller filer som inneholder sensitiv informasjon bør krypteres med type DLP tjenester for å unngå at informasjon kommer på avveie. Flere tjenester er tilgjenglig til f.eks SQL Server som kan kryptere informasjon slik data ikke kan leses direkte selv om uvedkommende har fått tak i data filene til databasen. Det finnes også tjenester som kan automatisk klassifisere og kryptere data basert på innhold som f.eks Microsoft AIP.  Overvåkning  Ha en sentralisert loggingstjeneste for overvåkning av bruker aktivitet. Viktige elementer og eventIDer som man bør følge med på er (Event ID 4625 (Failet pålogging), 4740 (konto last ute) eller 1102 (Event Cleared) her er også en kompilert liste over eventer man bør ha aktivert \u0026ndash;\u0026gt; https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/audit-policy-recommendations. For sentralisert overvåkning kan man benytte Windows Event Forwarding, SCOM Audit Collector, Splunk, ELK eller skytjenester som Azure Sentinel. Prosess overvåkning - Mange ransomware aktører bruker også tjenester som Anydesk, Teamviewer, Bloodhound, PSEXEC og annet for å kartlegge eller ha en enkel måte å gi tilgang til infrastrukturen på. Se på muligheten for å få sentralisert overvåkning på disse angitte prosessene som kan enten gjøres via EDR verktøy eller bruk av Sysmon fra Sysinternals pakken å deretter definere overvåknignsregler. Ha DNS Overvåkning - Man kan også forhindre og blokkere phising angrep, eller at tjenester prøver å oppnå kommunikasjon tilbake til noen Command og Control tjenester ved å forhindre dette på DNS nivå. Det finnes DNS tjenester som kan brukes som f.eks Cloudflare for Teams, Cisco Umbrella som forhindrer DNS oppslag mot mistenkelig DNS domener. Samtidig bør man også ha DNS overvåkning på plass for å kunne se etter mistenkelig domener som det har blitt gjort oppslag mot. Flere ransomware aktører benytter nå også nyere protokoller for innhenting av script og annen payload via tjenester som f.eks HTTP/3 som i dag effektivt ikke kan inspiseres via brannmur eller proxy tjenester. Man bør også ha en EDR/XDR tjenester på sluttbrukerens maskiner for å kunne se på nettverksflyten. Logg trafikk også tilknyttet TerminalServices-RemoteConnectionManager samt Security og SMB loggene jevnlig for å se etter unormal aktivitet.  ","permalink":"https://trusselsky.github.io/posts/ransomware/","summary":"De siste månedene har det vært en voldsom økning knyttet til ransomware angrep, derfor ønsket vi å komme med en den generelle råd i forhold til hvordan man kan redusere risikoen for å bli utsatt for ransomware angrep. NB: Dette er en liste med tiltak som vil bli kontinuerlig oppdatert (19/09/2021)\nDet er viktig å påpeke at ransomware angrep har i det siste også vært mye tidligere ute med å ta i bruk nye sårbarheter.","title":"Hvordan redusere risikoen for å bli utsatt for Ransomware angrep"},{"content":"Tidligere i sommer stoppet Cloudflare det som er beskrevet som det største DDoS angrepet noensinne, med lit over 17.2 millioner forespørsler-per-sekund over HTTP trafikk (som ofte gjøres for å kamuflere angrepet som mer legitim trafikk). Til sammenligning så håndterer Cloudflare som i dag leverer cirka 13% av all HTTP trafikk på verdensbasis, ca 25 millioner forespørsler-per-sekund. Motivet bak å kjøre DDoS angrep er for å kunne gjøre tjenester utilgjengelig eller for å ta ned infrastruktur med å overbelaste systemene.\nOfte kjøres slike angrep fra kontrollerte Botnet. Som er maskiner som er infisert med malware som igjen blir styrt av en Botnet Operatør for å kunne utføre DDoS angrep.\nSamtidig kan vi også se at det skjer flere DDoS mot Norge organisasjoner, som man kan se mer info av her \u0026ndash;\u0026gt; (https://radar.cloudflare.com/no) som ofte gjøres av ulike årsaker.\n1: For å gjennomføre et ransomware angrep (Enten betaler du X antall kroner eller så vil din tjeneste være utilgjengelig) Dette har vi sett også kan gjøres samtidig som hackere gjør angrep via andre vektorer også. Dette er blant annet noe som ble gjort mot Vinmonopolet i fjor høst \u0026ndash;\u0026gt; https://www.digi.no/artikler/hackerne-tok-ned-vinmonopolet-no-i-dag-har-de-varslet-et-mye-verre-angrep/504268\n2: For å gjøre en tjeneste utilgjengelig, enten politisk mål eller andre årsaker.\nSamtidig vil vi se en trend fremover med flere DDoS angrep. Litt av bakgrunn for dette er fordi at flere applikasjoner og tjenester nå bytter gradvis over til å bruke UDP basert transport i stedet for tradisjonelle TCP. Dette da for å kunne redusere latency å andre hopp frem og tilbake på kommunikasjon samt gi en bedre brukeropplevelse på noen tjenester. På toppen av UDP er det flere nå som benytter DTLS som protokoll. DTLS er en protokoll som er hybrid som gir same pålitelighet som TCP men levert via UDP. Spesielt er det tjenester som Citrix HDX, Microsoft RDP samt Zscaler og noen VPN leverandører som DTLS som kommunikasjonsprotoll.\nEn grunn til at dette vil gi flere DDoS angrep er pga hvordan de ulike leverandørene har implementert DTLS protokollen. Som en del av standarden er det en attributt som er angitt i standarden som en opsjon (å er derfor ikke nødvendig). Denne atributten gjør at om noen initierer et angrep mot en tjeneste via DTLS, vil tjeneren svare med en Cookie under (HelloVerifyRequest) for å forsikre seg om at kommunikasjonen kommer fra en legitim klient, den kommunikasjon blir etablert. For tjenester som ikke har implementert denne attributten på tjenester som bruker DTLS vil angripere i visse sammenhenger kunne utnytte dette for et omvendt DDoS angrep.\nDe siste årene har det vært en svakhet som har kommet frem både fra Microsoft RDP (via RD Gateway) og Citrix NetScaler ADC (for Citrix sesjoner) du kan også lese en eldre artikkel her fra Palo Alto om problematikken som var tidligere på Microsoft \u0026ndash;\u0026gt; https://unit42.paloaltonetworks.com/dtls-vulnerabilities-cve-2014-6321/\nDen andre utfordringen er at mer og mer av vanlig web trafikk beveger seg over til å bruke HTTP/3 som nå begynner å bli ferdig som en standard. Statistikk som man kan se her, så er cirka 10% av all trafikk som går mot Norske sider via Cloudflare basert på HTTP/3 \u0026ndash;\u0026gt; https://radar.cloudflare.com/no du kan også lese mer om HTTP/3 her \u0026ndash;\u0026gt; https://trusselsky.no/posts/http3ogfremtiden/ Utfordringen ligger i trafikk inspeksjon. Mange av dagens brannmur/sikkerhetstjenester er avhengig av å kunne inspisere trafikken for å kunne avdekke angrep eller skadelig innhold. Med HTTP/3 så er det ikke mulig å få direkte inspeksjon av innholdet å derfor vil det vær enklere for angripere å kunne kamuflere innholdet når de gjennomfører et angrep. Samtidig så legger HTTP/3 mer trykk på serveren i form av ressurser for å håndtere kommunikasjonen, som gjør også at et DDoS angrep via HTTP/3 vil ikke kreve like mye trafikk for å kunne ta ned en tjeneste.\nHeldigvis har vi ennå ikke sett store angrep som har blitt gjort via HTTP/3, men basert på trenden vil nok dette også øke fremover \u0026ndash;\u0026gt; https://blog.cloudflare.com/ddos-attack-trends-for-2021-q2/ som man må være varsom til nettverksaktivitet mot eksterne tjenester. Spesielt om man som virksomhet leverer f.eks nettbutikker kan man være veldig utsatt for slike angrep.\n","permalink":"https://trusselsky.github.io/posts/merddos/","summary":"Tidligere i sommer stoppet Cloudflare det som er beskrevet som det største DDoS angrepet noensinne, med lit over 17.2 millioner forespørsler-per-sekund over HTTP trafikk (som ofte gjøres for å kamuflere angrepet som mer legitim trafikk). Til sammenligning så håndterer Cloudflare som i dag leverer cirka 13% av all HTTP trafikk på verdensbasis, ca 25 millioner forespørsler-per-sekund. Motivet bak å kjøre DDoS angrep er for å kunne gjøre tjenester utilgjengelig eller for å ta ned infrastruktur med å overbelaste systemene.","title":"DDoS angrep og trender fremover"},{"content":"Det ble kjent tidligere i dag, at en av de store DeFi platformene Poly Network ble hacket via en svakhet i en mekanisme som kalles for EthCrossChainManager som brukes for validering på tvers av ulike blockchain prosjekter. Hvor da angriperne overførte 610 millioner dollar til 3 ulike addresser fordelt på ulik valuta.\n $273M Ethereum $253M Binance Smart Chain $85M Polygon  Man kan se hele analysen av sårbarheten av angrepet her \u0026ndash;\u0026gt;\nPoly has this contract called the \u0026quot;EthCrossChainManager\u0026quot;. It\u0026#39;s basically a privileged contract that has the right to trigger messages from another chain. It\u0026#39;s a pretty standard thing for cross-chain projects.\n\u0026mdash; God-like Natural Number Creator Person (TM, R) (@kelvinfichter) August 10, 2021  Når en av de som gjennomføre angrepet skulle prøve å overføre med USDT TOKEN, ble han tipset av noen andre at han ikke måtte bruke det for da ble han svartlistet. Da fikk vedkommende som tipset dem om det overført 13.37 Ether samtidig også startet en strøm av flere folk som ønsker at hackeren skal overføre beløp til dem også (https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f) som man også kan se her at felre etterspør valuta \u0026ndash;\u0026gt; https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963\nKlikk videre for å se hele analysen. Her kan man også se status knyttet til undersøkelsen fra Poly Network selv.\nAssets involved include $DAI $UNI $SHIB $FEI.\nETH:0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963\nWe call on miners of affected blockchain and crypto exchanges to blacklist tokens coming from the above addresses. @MakerDAO @Uniswap @Shibtoken @feiprotocol\n\u0026mdash; Poly Network (@PolyNetwork2) August 10, 2021  Noe av valutaen er nå fryst, mer info følger.\n","permalink":"https://trusselsky.github.io/posts/polynetworkshack/","summary":"Det ble kjent tidligere i dag, at en av de store DeFi platformene Poly Network ble hacket via en svakhet i en mekanisme som kalles for EthCrossChainManager som brukes for validering på tvers av ulike blockchain prosjekter. Hvor da angriperne overførte 610 millioner dollar til 3 ulike addresser fordelt på ulik valuta.\n $273M Ethereum $253M Binance Smart Chain $85M Polygon  Man kan se hele analysen av sårbarheten av angrepet her \u0026ndash;\u0026gt;","title":"Poly Network hacket, 600 millioner dollar tatt"},{"content":"Under årets BlackHat Conference, ble det presentert detaljer rundt nye sårbarheter som ble kjent i Microsoft Exchange som nå har blitt dubbet til \u0026ldquo;ProxyShell\u0026rdquo; som er en kombinasjon av 3 sårbarheter.\n CVE-2021-34473 - Pre-auth Path Confusion leads to ACL Bypass (Fikset i April av KB5001779) CVE-2021-34523 - Elevation of Privilege on Exchange PowerShell Backend (Fikset i April av KB5001779) CVE-2021-31207 - Post-auth Arbitrary-File-Write leads to RCE (Fikset i Oppdatering i Mai av KB5003435)  Sårbarhetene kan gjøre at uvedkommende kan få tilgang til Exchange løsningen å laste ned epost databaser som da inneholder alt av f.eks epost kontoer (epost, kalender,kontakter osv) siden tilgangen som uvedkommende får ved å utnytte sårbarhetene er lokal system.\nViktig at man dobbeltsjekker hvilken versjon man er på \u0026ndash;\u0026gt; https://exchangeserverversions.blogspot.com/2016/01/exchange-server-2016.html (Her er en liste for Exchange 2016)\nMERK: Dette er ikke samme sårbarhet som ble utnyttet i angrepet mot Stortinget som også benyttet en sårbarhet mot Exchange, som heter ProxyLogin.\nDisse sårbarhetene ble presentert av sikkerhetsforsker Orange Tsai (https://twitter.com/orange_8361)\nDu kan se presentasjonen her \u0026ndash;\u0026gt; https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf?fbclid=IwAR2V0-4k2yb8dmPP5Mksd8iHYTOfE6sBwygMt4wjq3M9be8Tw6TlH0andhA\nHer kan man også se et video eksempel hvor noen har laget script som utnytter alle sårbarhetene for å kunne ekspotere epost fra Exchange serveren.\n  Samtidig kan man også se at bare i Norge er det i overkant av 100+ som har offentlige Exchange servere som fortsatt er sårbare.\nSamtidig er det flere nå som merker økt Exchange trafikk, i tillegg er det noen angripere nå som allerede har begynt å utnytte sårbarhetene.\nMy Exchange honeypot has somebody dropping files and executing commands. https://t.co/pMVsl7y4iy\n\u0026mdash; Kevin Beaumont (@GossiTheDog) August 6, 2021  Indikatorer Flere som scanner nå etter sårbare Exchange servere prøver å utnytte sårbarheten via Autodiscovery bibloteket på CAS serverene. Et eksempel som har blitt flagget er trafikk mot\nhttps://exchange-server/autodiscover/autodiscover.json?@abc .com/owa/?\u0026amp;Email=autodiscover/autodiscover.json%3F@abc.com Om din Exchange løsning fortsatt er sårbar vil den respondere med en HTTP 302 kode tilbake.\n","permalink":"https://trusselsky.github.io/posts/proxyshellexchange/","summary":"Under årets BlackHat Conference, ble det presentert detaljer rundt nye sårbarheter som ble kjent i Microsoft Exchange som nå har blitt dubbet til \u0026ldquo;ProxyShell\u0026rdquo; som er en kombinasjon av 3 sårbarheter.\n CVE-2021-34473 - Pre-auth Path Confusion leads to ACL Bypass (Fikset i April av KB5001779) CVE-2021-34523 - Elevation of Privilege on Exchange PowerShell Backend (Fikset i April av KB5001779) CVE-2021-31207 - Post-auth Arbitrary-File-Write leads to RCE (Fikset i Oppdatering i Mai av KB5003435)  Sårbarhetene kan gjøre at uvedkommende kan få tilgang til Exchange løsningen å laste ned epost databaser som da inneholder alt av f.","title":"ProxyShell - Nye sårbarheter mot Exchange"},{"content":"Denne viser ulikk statistikk fra honeypot miljøet vårt. Hvor vi blant annet måler eller kjente IP addresser som blir brukt for ondsinnet formål.Data kommer fra vårt Azure miljø å blir oppdatert ved neste datainnsamling. (Historiske data viser de siste 30 dagene) (Oppdatert 30. August) data er samlet inn fra ulike virtuelle maskiner som kjører i Microsoft Azure.\n \nFeilet pålogging via RDP - Land Tabellen under viser påloggingsforsøk mot Windows Honeypot miljøet, basert på spesifikk EventID og hvilken IP addresser som er oftest brukt. Denne viser blant annet påloggingsforsøk via RDP og er filtrert etter topp 15 IP-addresser.\n   IP Addresse Event ID Land Antall påloggings forsøk      Feilet pålogging via RDP - UPN Tabellen under viser påloggingsforsøk mot Windows Honeypot miljøet, basert på mest brukte kontonavn (UPN).\n   Kontonavn Antall påloggings forsøk      Trafikk port - Land Tabellen under viser påloggingsforsøk mot Windows Honeypot miljøet, basert på mest brukte kontonavn (UPN).\n   Port Land Antall      App Registration    ExpiryDate DisplayName Owners     11/3/2018 6:05:44 PM VMware2 b13a094e-4465-4794-b484-0afad7d07c99   12/30/2299 11:00:00 PM Cloudcheckr 223e8559-3b7b-44df-b2a3-018209b1fd7f   7/17/2018 6:50:00 AM CitrixAccess a2b35350-2b21-4cdb-8007-61828a584dc7   8/16/2023 5:21:30 PM dsc365 3af2ed22-3b26-4fd1-893e-582630d7af6b   2/18/2022 5:00:49 PM sptf-msandbuorg 40cb3236-0ca3-404e-8107-4727e9d77008   9/1/2022 12:00:00 AM aakjhkjhkj_6D\u0026#43;nt/2Vp9k/F23\u0026#43;/Aoz2/ETWXNwMlLraXqeaSMaXMY= 759210e9-f383-4b4b-89fa-2e481a1bf589   12/30/2299 11:00:00 PM NetScaler Gateway f35d1daf-5497-4f29-9df0-4eb023b96a1c   11/14/2017 12:00:00 AM automation_jfzMf1TOC/jxZhmoNQ/JZRUlOzj3cRDS1K\u0026#43;oruydAUg= a3595bdf-a885-40b4-b396-10072e8e344d   12/30/2299 11:00:00 PM scom 380af21e-f532-4e87-9f28-3eb70532370b   11/3/2018 6:04:01 PM VMWARE 8b7d0369-9504-46ec-bc11-30c84a9c5318   10/24/2018 7:29:30 PM VMWARE 880741cb-7914-429d-bbe8-a1739334b3fd   10/23/2018 9:40:08 PM VMWARE 99eb11e2-7c6a-4410-a512-4ff21b504c78   10/23/2018 9:19:57 PM VMWARE 2ed209f7-294b-414c-987e-7624e91d1e93   10/21/2018 5:52:27 PM VMWARE f8d92d72-b666-4d9c-9f08-14e1728170c6   10/21/2018 5:50:02 PM VMWARE c5d9c356-f4da-47b1-bc7c-08dbd668f130   10/21/2018 5:47:36 PM VMWARE 8cbb3429-f2a8-4028-ade7-d883d8b32315   5/23/2019 11:09:34 PM NSGW 3b85554d-539e-4ce6-82e2-899829e93c26    ","permalink":"https://trusselsky.github.io/stats/","summary":"Denne viser ulikk statistikk fra honeypot miljøet vårt. Hvor vi blant annet måler eller kjente IP addresser som blir brukt for ondsinnet formål.Data kommer fra vårt Azure miljø å blir oppdatert ved neste datainnsamling. (Historiske data viser de siste 30 dagene) (Oppdatert 30. August) data er samlet inn fra ulike virtuelle maskiner som kjører i Microsoft Azure.\n \nFeilet pålogging via RDP - Land Tabellen under viser påloggingsforsøk mot Windows Honeypot miljøet, basert på spesifikk EventID og hvilken IP addresser som er oftest brukt.","title":"Stats"},{"content":"Arbeidsgruppen i IETF begynner å komme i mål med HTTP/3 standarden som vil påvirke både ytelsen og sikkerheten på all nett-trafikk, så hva er de viktigste endringene å hvordan påvirker det også sikkerheten?\nHistorien så langt Det skjer for tiden veldig mye utvikling på teknologifronten når det gjelder web og hvordan vi kommuniserer med netttjenester. Når man åpner en nettleser mot f.eks vg.no vil enhenten du sitter på benytte en rekke nettverksprotokoller for å kommunisere med VG sin infrastruktur.\nProtokollen som benyttes i bunn på nettleser trafikk er HTTP. HTTP har eksistert lenge og majoriteten av nettlesern trafikken i dag benytter HTTP 1.1 protokollen (som har eksistert siden 90-tallet). Problemet med den protokollen var (og er) all trafikk blir sendt i klartekst, derfor måtte man lage en ny versjon av denne protokollen som her HTTPS som krypterer innholdet mellom tjenester og enhet. Her benyttet man til og begynne med SSL og deretter TLS protokollen som krypteringsprotokoll for å kryptere innholdet mellom klient og tjener.\nHTTP benytter TCP som kommunikasjonsprotokoll for overføring av data, som også gjør den sårbar for pakketap eller høy latency. Kombinert med TLS kommunikasjonen fører til høyere tid mellom klient og tjenester for å få etablert kommunikasjon.\nHTTP 1.1 som protokoll har også en del svakheter blant annet at den ikke støtter multiplexing på en god måte som gjør at HTTP trafikk som kommer fra ulike tjenere må vente i tur. Samtidig med f.eks HTTP/2 kom de også med multiplexing som gjør at man ikke får dette problemet. Samtidig introduserte de også blant annet HPACK (Header Compression) som gjør at man reduserer båndbredden.\nNår HTTP/2 standarden kom valgte også flere leverandører og kreve at all kommunikasjon som skulle støtte HTTP/2 måtte bruke TLS som standard. Som gjorde blant annet f.eks ulike nettlesere som Firefox, Chrome og Edge krever HTTPS når man skal bruke HTTP/2 som protokol.\nNB: Med TLS 1.3 prøver man å redusere tiden det tar å etablere kommunikasjon mellom klient og tjener ved å benytte. Her ser man en sammenligning mellom TLS 1.2 over HTTP mot TLS 1.3\nSamtidig som utviklingen har pågått med å prøve å sikre kommunikasjonen (som også i utgangspunktet har ført til tregere kommunikasjon og flere forsinkende ledd) har web utviklingen rast videre, hvor vi nå har mye mer multimedia innhold (bilder,videoer) mye mer 3.parts biblotek og eksterne tjenester. Før var nettleser trafikken mer statisk innhold, hvor det nå har blitt til mye dynamisk innhold og store rammeverk (CMS) med mer multimedia og streaming mekanismer som gjør at man må ha en transport mekanisme som kan overføre data mer effektivt.\nSikkerhet og inspeksjon Med introduksjon av SSL/TLS krypteringsprotokollene betydde dette at kommunikasjon ble kryptert. (dog dette betyr ikke at innholdet nødvendigvis er trygt)\nHTTPS \u0026amp; SSL doesn\u0026#39;t mean \u0026quot;trust this.\u0026quot; It means \u0026quot;this is private.\u0026quot; You may be having a private conversation with Satan.\n\u0026mdash; Scott Hanselman (@shanselman) April 4, 2012  Med mer ondsinnet trafikk som gikk over nett betydde dette at flere måtte begynne å bruke tjenester for å kunne analysere innholdet (som i dag tilbys av de fleste brannmur/proxy leverandører). Dette kunne da analysere innholdet etter f.eks ondsinnet trafikk eller beskytte brukere fra ukjente adresser eller annet innhold. Flere leverandører bruker også lignende mekanismer for å kunne kategorisere innhold samt definere hvilken applikasjon/tjeneste som en bruker kobler seg opp i mot. Dette betyr i prinsippet at proxy/brannmur tjenesten dekrypterer innholdet for å kunne \u0026ldquo;se\u0026rdquo; hva som skjer i trafikk strømmen før trafikken blir kryptert igjen og sendt videre, som en type MiTM (Man-in-the-middle) tjeneste.\nDenne mekanismen ble også brukt for lastbalanseringstjenester der man kunne balansere trafikk basert på spesifikt innhold.\nHvorfor HTTP/3 ? Allerede nå er det mange nettsider/leverandører som har beveget seg videre til HTTP/3, som man ser her så er cirka 13% av all kommunikasjon går via HTTP/3 protokollen Som store leverandører som Google, AWS og Cloudflare, mens resten er fordelt på HTTP 1.1 og HTTP/2 (Statistikk fra Cloudflare Radar siste 30 dagene) som også er supportert av de fleste moderne nettlesere.\nMen man ser også at HTTP/3 har vesentlig forbedret tiden det tar både å etablere kommunikasjon samt også hvordan håndtere pakketap.\nSå er forandret i HTTP/3 ?\n I stedet for TCP benytter HTTP/3 seg av QUIC (Quick UDP Internet Connections) som overføringsprotokoll som er bygget på UDP. Men samtidig tilbyr flere av TCP egenskapene som pålitlighet og overbelastingskontroll algoritmer som f.eks CUBIC eller New Reno. (Dette krever dog at UDP/443 er åpnet i brannmuren) Benytter seg QPACK for komprimering av HTTP headere (Sammenlignet med HPACK som ble brukt i HTTP/2) Krever TLS kryptering for kommunikasjon (Var ikke et krav i HTTP/2, selv om flere leverandører krevde det)  Samtidig er også kryptering som før har blitt håndtert av TLS nå gjort direkte i kommunikasjonsprotokollen som gjør at trafikk inspeksjon som før ble gjort av brannmurer/proxy tjenester ikke lenger er mulig.\nHvordan sikre trafikk fremover ? Med mer og mer av internett trafikken beveger seg mot bruk av HTTP/3 samtidig som standarden blir ferdigstilt, betyr dette også at flere organisasjoner må ta stilling til hvordan det skal håndtere HTTP/3 trafikken. Flere leverandører nå begynner å komme med støtte for HTTP/3\n Blant annet så kommer nå Microsoft med en ny versjon av SMB som også støtter QUIC (https://techcommunity.microsoft.com/t5/itops-talk-blog/smb-over-quic-files-without-the-vpn/ba-p/1183449) Google Cloud støtter QUIC (https://cloud.google.com/blog/products/networking/cloud-cdn-and-load-balancing-support-http3) Citrix ADC Quic (https://docs.citrix.com/en-us/citrix-adc/current-release/system/quic.html)  Akkurat nå er det få til ingen brannmur/proxy leverandører som supporterer inspeksjon av QUIC og HTTP/3 og den generelle anbefalingen er å deaktivere de protokollene i brannmuren, men dette gjør at klientene som sitter på innsiden vil falle tilbake til HTTP 1.1 med TLS. Samtidig beveger flere seg på utsiden av den tradisjonelle brannmuren ved å jobbe fra hjemme eller andre lokasjoner, som gjør at den tradisjonelle brannmuren mister litt av den orginale hensikten ved å beskytte trafikken mellom innsiden og utsiden.\nDerfor vil det være viktig fremover å se på løsninger som gir mer innsikt direkte fra endepunktet perspektivet for å kunne ivareta sikkerhet på samme måte, men samtidig ivareta forbedringene som HTTP/3 kommer med.\n","permalink":"https://trusselsky.github.io/posts/http3ogfremtiden/","summary":"Arbeidsgruppen i IETF begynner å komme i mål med HTTP/3 standarden som vil påvirke både ytelsen og sikkerheten på all nett-trafikk, så hva er de viktigste endringene å hvordan påvirker det også sikkerheten?\nHistorien så langt Det skjer for tiden veldig mye utvikling på teknologifronten når det gjelder web og hvordan vi kommuniserer med netttjenester. Når man åpner en nettleser mot f.eks vg.no vil enhenten du sitter på benytte en rekke nettverksprotokoller for å kommunisere med VG sin infrastruktur.","title":"HTTP/3 og fremtidens websikkerhet"},{"content":"Flere og flere organisasjoner begynner å ta i bruk Kubernetes som platform for å levere fremtidige microtjenester. Kubernetes er også et veldig komplekst økosystem som kan bestå av mange ulike elementer i forhold til nettverkskontroll, konfigurasjonskontroll og CI/CD blant annet.\nNår man skal designe en Kubernetes platform, bør man ha en god forståelse på hvordan man skal sikre løsningen. Her vil det ligge lenker og oppdatert informasjon på referanse arkitektur og best-pratices i forhold til sikring av Kubernetes og tjenester.\n DoD DevSecOps: Reference Design Kubernetes Hardening Guidance  ","permalink":"https://trusselsky.github.io/posts/sikringavkubernetes/","summary":"Flere og flere organisasjoner begynner å ta i bruk Kubernetes som platform for å levere fremtidige microtjenester. Kubernetes er også et veldig komplekst økosystem som kan bestå av mange ulike elementer i forhold til nettverkskontroll, konfigurasjonskontroll og CI/CD blant annet.\nNår man skal designe en Kubernetes platform, bør man ha en god forståelse på hvordan man skal sikre løsningen. Her vil det ligge lenker og oppdatert informasjon på referanse arkitektur og best-pratices i forhold til sikring av Kubernetes og tjenester.","title":"Sikring av Kubernetes og tjenester"},{"content":"Den (28/07) Annonserte GitHub at som en del av Code Scanning tjenesten de leverer at de nå har kommet med 15 nye integrasjoner med åpne kildekode rammeverk som dekker rammeverk som Ruby, PHP, Switch, Terraform, PowerShell og Kubernetes YAML.\nCode Scanning funksjonen ble lansert i 2020 som er tilgjengelig for alle offentelige repositories samt for Private repositories (Krever GitHub Advanced) men gjør at man kan se igjennom kildekoden etter sårbarheter.\nHvordan sette opp Code Scanning Code Scanning kan aktiveres ved å gå inn på et Repository \u0026ndash;\u0026gt; Security \u0026ndash;\u0026gt; Overview \u0026ndash;\u0026gt; Code Scanning\nDeretter må man velge basert på hvilken rammeverk man benytter. Man kan benytte seg av de innebydge arbeidsflyten som er egen basert på definert rammeverk eller man kan bruke CodeQL Analysis\nGitHub Actions med CodeScanning med Terraform Med et eksempel her, skal vi vise hvordan man kan bruke Code Scanning sammen med tfsec for å scanne et Github repository som inneholder Terraform kode for å se etter ikke-sikker konfigurasjon. Code Scanning benytter GitHub Actions, hvor tjenesten vil via en Ubuntu-Worker laste ned innholdet i GitHub repositoriet. Som et eksempel her har vi laget følgende.\n  Fork innholdet i repositoriet her \u0026ndash;\u0026gt; https://github.com/snyk/terraform-goof\n  Gå inn på Security \u0026ndash;\u0026gt; Overview \u0026ndash;\u0026gt; Code Scanning \u0026ndash;\u0026gt; Velg tfsec fra listen klikk Setup this workflow. Dette vil da lage en Github Actions Workflow i ditt repository som vil kjøres hver gang ny kode sjekkes inn. Konfigurasjon vil du kunne se under ./guthub/workflows mappen. Du kan se et eksempel på det her \u0026ndash;\u0026gt; (https://github.com/trusselsky/terraform-goof)\n  Om du vil sette opp workflow direkte fra lokale IDE og pushe konfigurasjon via Git kan du bruke følgende template.\n  name: tfsec on: push: branches: [ master ] pull_request: branches: [ master ] schedule: - cron: '15 13 * * 5' jobs: tfsec: name: Run tfsec sarif report runs-on: ubuntu-latest permissions: actions: read contents: read security-events: write steps: - name: Clone repo uses: actions/checkout@v2 - name: Run tfsec uses: tfsec/tfsec-sarif-action@9a83b5c3524f825c020e356335855741fd02745f with: sarif_file: tfsec.sarif - name: Upload SARIF file uses: github/codeql-action/upload-sarif@v1 with: # Path to SARIF file relative to the root of the repository sarif_file: tfsec.sarif NB: Tfsec har en del innebygget sjekker mot ulike providere i Terraform, mer informasjon kan finnes her (https://tfsec.dev/docs/installation/)\nNår flyten er implementert vil den gå igjennom kildekoden å laste opp eventuelle resultat inn i en SARIF fil. Github vil lese innholdet i den genererte SARIF filen for å vise alarmer som kommer frem. Du kan se resultatet under Security \u0026ndash;\u0026gt; Code Scanning Alerts\n","permalink":"https://trusselsky.github.io/posts/kodescanninggithub/","summary":"Den (28/07) Annonserte GitHub at som en del av Code Scanning tjenesten de leverer at de nå har kommet med 15 nye integrasjoner med åpne kildekode rammeverk som dekker rammeverk som Ruby, PHP, Switch, Terraform, PowerShell og Kubernetes YAML.\nCode Scanning funksjonen ble lansert i 2020 som er tilgjengelig for alle offentelige repositories samt for Private repositories (Krever GitHub Advanced) men gjør at man kan se igjennom kildekoden etter sårbarheter.","title":"Sårbarhetsscanning med GitHub mot kjente rammeverk"},{"content":"Som en del av Windows 11, har Microsoft introdusert en del rekke endringer i forhold til sikkerhet og hardware krav som følger de sikkerhetsfunksjonene. En av de største endringene er at Microsft nå vil kreve at maskiner som skal kjøre Windows 11 på fysiske maskiner, støtter en funksjon i Windows som heter Measured Boot.\nMeasured Boot Measured Boot er delt opp i 2 deler, ene som er Secure Boot prosessen som ble laget for at operativsystemet kun starter opp med programvare som leverandøren kan stole på. Når maskinen starter Secure boot vil den første finne OS Bootloader partisjonen, verifisere at firmwaren er digital signert samt at den ikke er modifisert. Om innholdet er inntakt vil den deretter starte operativsystemet. Andre delen som kalles Trusted Boot sjekker integriteten av alle Windows baserte komponenter (samt ELAM \u0026ldquo;Early Launch Anti-Malware\u0026rdquo; sjekker at alle drivere er digital signerte før de blir lastet inn i bruker kontekst).\nNB: Secure Boot er en funksjon som ligger i UEFI å ikke noe Microsoft har utviklet.\nFor å kunne bruke Measured Boot (m/Secure boot) i Windows krever to ting, det ene er UEFI firmware samt TPM på maskinen.\nHva slags angrep stopper denne tjenesten? Selve sikkerhetsmekanismen er beregnet på å stoppe Bootkits og RootKits. Bootkits er skadelig kode som starter før selve operativsystemet laster inn som gjør at om man skulle bli infisert av en Bootkit, kan koden ligge i maskinen og overleve reinnstallasjon av operativsystem blant annet. Trickbot er en malware aktør som benytter seg av Bootkit som de har kalt TrickBoot (Man kan lese mer om det her \u0026ndash;\u0026gt; https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/)\nSamt med ELAM og verifisering av Windows komponenter kan man også unngå Rootkits ved at anti-virus tjenesten kan starte før en eventuelt Rootkit som ofte starter som en prosess eller scheduled task kan starte.\nSelvsagt viktig å påpeke at disse sikkerhetsfunksjonene vil ikke ha noe direkte effekt mot f.eks ransomware angrep, hvor angripere ofte angriper kjørende maskiner ved å utnytte andre sårbarheter. Men dette er rettet mot f.eks mot fysisk angrep hvor noen prøver å modifisere boot prosessen.\nHvorfor er disse TPM kravene her? Så trenger jeg virkelig TPM? å i tilfelle hvilken versjon trenger jeg? Microsoft har endret litt på kravene sine, så for å få lov til å innstallere Windows 11 må man ha støtte for ihvertfall TPM 1.2 eller høyere.\nTPM 1.2 standaren ble ferdig i 2011 så mange av dagens maskiner har\nMan kan også slå av denne sjekken under installasjon ved å legge til en enkel registry nøkkel på maskinen. Ved innstallasjon trykk Shift+F10, åpne registry og legg til nøkkel\nHKEY_LOCAL_MACHINE\\SYSTEM\\Setup “BypassTPMCheck”=dword:00000001 “BypassSecureBootCheck”=dword:00000001 Microsoft anbefaler at man helst har TPM 2.0 chip på maskinene pga det er en stor løft fra TPM 1.2 til TPM 2.0 \u0026ndash;\u0026gt; (https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-recommendations#tpm-12-vs-20-comparison)\nAndre funksjoner som vil kreve dette Microsoft ønsker også å kunne benytte denne funskjonen som en autentiseringsfaktor også. Mange av tilgangsmekanismene som i dag finnes i Azure AD er basert på enten bruker m/tofator autentisering. Men i bunnen av Windows 11 har Microsoft også utviklet en ny funksjon for utveksling av helse status på maskinen.\nSom betyr f.eks at Windows 11 maskiner kan sende helse signal til Azure AD ved å gi beskjed om status i forhold til Secure Boot før f.eks en enhet får tilgang til data og tjenester, men dette er noe som kommer på sikt.\nMer informasjon NSA har også laget en god oppsummering på UEFI og Secure Boot prosessen \u0026ndash;\u0026gt; https://media.defense.gov/2020/Sep/15/2002497594/-1/-1/0/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF\n","permalink":"https://trusselsky.github.io/posts/windows11ogsecureboot/","summary":"Som en del av Windows 11, har Microsoft introdusert en del rekke endringer i forhold til sikkerhet og hardware krav som følger de sikkerhetsfunksjonene. En av de største endringene er at Microsft nå vil kreve at maskiner som skal kjøre Windows 11 på fysiske maskiner, støtter en funksjon i Windows som heter Measured Boot.\nMeasured Boot Measured Boot er delt opp i 2 deler, ene som er Secure Boot prosessen som ble laget for at operativsystemet kun starter opp med programvare som leverandøren kan stole på.","title":"Windows 11 og Measured Boot m/TPM"},{"content":"U.S. Cybersecurity og Infrastructure Security Agency (CISA) har sammen laget en liste med de (top 30) vanligste sårbarhetene som blir utnyttet i angrep, basert på historiske data fra 2020 (samt sålangt i 2021)\nDu kan se listen over de ulike sårbarheten her \u0026ndash;\u0026gt; https://us-cert.cisa.gov/ncas/alerts/aa21-209a PDF utgave her \u0026ndash;\u0026gt; https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf\nSårbarhetene kommer fra en ulike rekke leverandører. Basert på historikk data fra 2020, er følgende de meste utnyttet sårbarhetene:\n Citrix - CVE-2019-19781 - arbitrary code execution Pulse - CVE 2019-11510 - arbitrary file reading Fortinet - CVE 2018-13379 - path traversal F5- Big IP - CVE 2020-5902 - remote code execution (RCE) MobileIron - CVE 2020-15505 - RCE Microsoft - CVE-2017-11882 - RCE Atlassian - CVE-2019-11580 - RCE Drupal - CVE-2018-7600 - RCE Telerik - CVE 2019-18935 - RCE Microsoft - CVE-2019-0604 - RCE Microsoft - CVE-2020-0787 - elevation of privilege Microsoft - CVE-2020-1472 - elevation of privilege  Vi så blant annet at Citrix sårbarheten alene kunne påvirke opptil 850 organisasjoner i Norge. Samt blant annet CVE-2021-26855 (Microsoft Exchange) som ble utnyttet mot Stortinget som gjorde det mulig for angripere å hente ut Epost kontoer fra den lokale Exchange databasen ved å kjøre egendefinert kode mot OWA/EXC.\nI 2021 fortsetter angripere å benytte seg av målrettet sårbarheter mot enheter/tjenester som er offentlig tilgjengelig. Blant de som er svært utnyttet så langt i 2021, er sårbarheter i Microsoft, Pulse, Accellion, VMware og Fortinet.\nDe har også kompilert en liste over de ulike CVEene med tiltak man kan gjøre for å fikse opp i de ulike sårbarhetene.\n","permalink":"https://trusselsky.github.io/posts/mestutnyttets%C3%A5rbarheter/","summary":"U.S. Cybersecurity og Infrastructure Security Agency (CISA) har sammen laget en liste med de (top 30) vanligste sårbarhetene som blir utnyttet i angrep, basert på historiske data fra 2020 (samt sålangt i 2021)\nDu kan se listen over de ulike sårbarheten her \u0026ndash;\u0026gt; https://us-cert.cisa.gov/ncas/alerts/aa21-209a PDF utgave her \u0026ndash;\u0026gt; https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf\nSårbarhetene kommer fra en ulike rekke leverandører. Basert på historikk data fra 2020, er følgende de meste utnyttet sårbarhetene:\n Citrix - CVE-2019-19781 - arbitrary code execution Pulse - CVE 2019-11510 - arbitrary file reading Fortinet - CVE 2018-13379 - path traversal F5- Big IP - CVE 2020-5902 - remote code execution (RCE) MobileIron - CVE 2020-15505 - RCE Microsoft - CVE-2017-11882 - RCE Atlassian - CVE-2019-11580 - RCE Drupal - CVE-2018-7600 - RCE Telerik - CVE 2019-18935 - RCE Microsoft - CVE-2019-0604 - RCE Microsoft - CVE-2020-0787 - elevation of privilege Microsoft - CVE-2020-1472 - elevation of privilege  Vi så blant annet at Citrix sårbarheten alene kunne påvirke opptil 850 organisasjoner i Norge.","title":"Vanligste sårbarhetene i 2020/2021"},{"content":"","permalink":"https://trusselsky.github.io/artikler/","summary":"","title":"Artikler"},{"content":"Hva er det? Den 30 Juli, ble det avdekket en sårbarhet i Print Spooler tjenesten i Windows. Som er en innebygget tjeneste i Windows som håndterer utskrift samt er også ansvarlig for driver innstallasjon knyttet til oppkobling av skrivere på Windows operativsystem.\nDet har kommet en del informasjon knyttet til denne sårbarheten samtidig som den er veldig omfattende og dekkes av flere CVE\u0026rsquo;er.\n1: CVE-2021-1675 (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675) som ikke er sårbarheten dubbet PrintNightmare. Microsoft kom med egen patch for denne med månedlig oppdateringer i Juli.\n2: CVE-2021-34527 (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527) har også kommet med egne patcher for de ulike operativsystemene.\n3: CVE-2021-34481 (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481) ny sårbarhet for lokal eskalering av tilganger. (Egen artikkel, kom 16 Juli)\nHvilken versjoner gjelder det? Denne sårbarheten gjelder alle Windows Operativsystem (både klient og Server) fra Windows 7/2008 til Windows 10/2019.\nHvilken konsekvenser har det? Denne sårbarheten kan gjøre det mulig å kompromitere maskiner i gitte scenarioer hvor man har Print Spooler tjenesten kjørende. Dette kan da være nettverksbaserte maskiner som domene kontrollere eller andre typer maskiner. Print Spooler tjenesten kjører som standard. Svakheten er definert slik at man kan lage en egendefinert DLL fil (som gjenspeiler en Print Driver) som man kan få print tjenesten i Windows til å importere under SYSTEM kontekst om Remote Printing tjenestne er aktivert. Denne egendefinerte DLL filen kan f.eks inneholde skjulte kommandoer for å tildele f.eks lokal administrator tilgang. Basert på informasjon vi har tilgjengelig er det ingen aktive angrep som benytter seg av denne angrepsvektoren ennå. Det krever tilgang til f.eks en maskin innenfor domenet for å kunne utnytte seg av sårbarheten som en da autentisert bruker.\nLøsninger/Workarounds Microsoft har kommet med sikkerhetsoppdateringer som løser sårbarheten. Men pga flere sårbarheter som nå blir avdekket i Print Spooler tjenesten, samt generell råd er at man deaktiverer Print Spooler tjenesten på maskiner som ikke har behov for den, som f.eks Domene kontrollere. Merk at sikkerhetsoppdateringene fra Microsoft krever omstart av maskinene som blir oppdatert.\n PowerShell eksempel  Stop-Service -Name Spooler -Force Set-Service -Name Spooler -StartupType Disabled Merk at ved å deaktivere Print Spooler tjenesten vil stoppe muligheten for å kjøre print jobber, dette omfatter også f.eks konvertering til PDF. For maskiner hvor man har behov for print som f.eks Citrix servere eller lokale arbeidsstasjoner er det anbefalt at man deaktiverer inbound remote print for å kunne\nMer informasjon  Eksempler på exploit https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527 Her er også et eksempel på hvordan man kan koble opp til en ekstern fiktiv print tjeneste som deretter gir System tilganger på maskinen. Merk at skaperen bak Mimikatz skriver også hvordan man kan begrense dette til kun godkjente systemer også via Group Policy. Want to test #printnightmare (ep 4.x) user-to-system as a service?🥝\n(POC only, will write a log file to system32)\nconnect to \\\\https://t.co/6Pk2UnOXaG with\n- user: .\\gentilguest\n- password: password\nOpen \u0026#39;Kiwi Legit Printer - x64\u0026#39;, then \u0026#39;Kiwi Legit Printer - x64 (another one)\u0026#39; pic.twitter.com/zHX3aq9PpM\n\u0026mdash; 🥝 Benjamin Delpy (@gentilkiwi) July 17, 2021    ","permalink":"https://trusselsky.github.io/posts/printnightmare/","summary":"Hva er det? Den 30 Juli, ble det avdekket en sårbarhet i Print Spooler tjenesten i Windows. Som er en innebygget tjeneste i Windows som håndterer utskrift samt er også ansvarlig for driver innstallasjon knyttet til oppkobling av skrivere på Windows operativsystem.\nDet har kommet en del informasjon knyttet til denne sårbarheten samtidig som den er veldig omfattende og dekkes av flere CVE\u0026rsquo;er.\n1: CVE-2021-1675 (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675) som ikke er sårbarheten dubbet PrintNightmare.","title":"PrintNightmare - CVE-2021-34527"},{"content":"Hva er det? Den 19 Juli, ble det avdekket en sårbarhet i SAM (Security Account Manager) databasen i Windows 10 på nyere versjoner. Denne sårbarheten gjorde at brukerdatabasen kunne bli lest av ikke-administrator kontoer i Windows 10 under en gitt kontekst. Dette var kun mulig å gjøre om det fantes VSS (Volume Shadow Service) som oftest brukes for å lage lokale snapshots i Windows (som f.eks Previous Versions). Om man har f.eks backup tjenester som brukes mot Windows 10 klient maskiner vil den ofte bruke VSS for å lage snapshots. Samt f.eks System Restore funksjonen i Windows bruker VSS for å lage snapshosts.\nSårbarheten ble avdekket av Jonas Lyk (https://twitter.com/jonasLyk/status/1417205166172950531)\nHvilken versjoner gjelder det? Dette gjelder Windows 10 (fra 1809 oppover) samt Windows Server 2019. Sårbarheten er kun mulig å utnytte om man har tilgang til å kjøre kode på det aktuelle systemet.\nHvilken konsekvenser har det? Om en klient maskin blir kompromitert samt har shadow copies lokalt på maskinen, kan en angriper bruke dette for å elevere seg selv til å bli lokal administrator. Eller hente ut informasjon om andre brukerkontoer som ligger igjen lokalt, som f.eks domene kontoer.\nLøsninger/Workarounds Microsoft har ikke kommet med patch ennå, men det finnes en workaround for å kunne løse opp i sårbarheten. Samtidig er det viktig å påpeke at sårbarheten ikke blir aktivt utnyttet ennå, men at Microsoft vil komme med en oppdatering fortløpende.\n Begrens tilgang til SAM databasen, kjør CMD/PowerShell som Administrator icacls %windir%\\system32\\config*.* /inheritance:e Slett tidligere Shadow Copies som ble laget før punkt 1 ble gjort. Her er mer informasjon knyttet til hvordan finne og slette Shadow Copies \u0026ndash;\u0026gt; https://support.microsoft.com/en-gb/topic/kb5005357-delete-volume-shadow-copies-1ceaa637-aaa3-4b58-a48b-baf72a2fa9e7  Mer informasjon  Microsoft CVE-2021-36934 (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934) Python PoC (https://github.com/GossiTheDog/HiveNightmare)  Video av Exploit   ","permalink":"https://trusselsky.github.io/posts/serioussam/","summary":"Hva er det? Den 19 Juli, ble det avdekket en sårbarhet i SAM (Security Account Manager) databasen i Windows 10 på nyere versjoner. Denne sårbarheten gjorde at brukerdatabasen kunne bli lest av ikke-administrator kontoer i Windows 10 under en gitt kontekst. Dette var kun mulig å gjøre om det fantes VSS (Volume Shadow Service) som oftest brukes for å lage lokale snapshots i Windows (som f.eks Previous Versions). Om man har f.","title":"Serious Sam - CVE-2021-36934"}]