<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Trusselsky</title>
    <link>https://trusselsky.github.io/posts/</link>
    <description>Recent content in Posts on Trusselsky</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Tue, 21 Sep 2021 23:28:51 +0200</lastBuildDate>
    
	<atom:link href="https://trusselsky.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Hvordan komme til en passordløs hverdag?</title>
      <link>https://trusselsky.github.io/posts/kommeigangmedpassordl%C3%B8s/</link>
      <pubDate>Tue, 21 Sep 2021 23:28:51 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/kommeigangmedpassordl%C3%B8s/</guid>
      <description>&lt;p&gt;Microsoft lanserte nylig at man kunne begynne å logge inn mot Microsoft-kontoen uten passord men heller benytte seg av Microsoft authenticator appen (eller andre mekanismer som f.eks fysiske adgangsnøkler) for innlogging.&lt;/p&gt;
&lt;p&gt;Funksjonen er ikke ny, men har primært vært tilgjenglig for bedriftsmarkedet frem til nå. Alikevel er det ikke mange som har benyttet seg av funksjonaliteten, derfor ønsket vi å belyse litt hvordan tjenesten fungerer. Litt om hva som behøves, hva som er supportert og hvorfor det er sikrere en vanlig brukernavn og passord. Samt litt om økosystemet rundt å hvem som supporterer denne autentiseringsmekanismen.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/passordl%c3%b8s1.png&#34; alt=&#34;FIDO2&#34;  /&gt;
&lt;/p&gt;
&lt;h2 id=&#34;fido2&#34;&gt;FIDO2&lt;/h2&gt;
&lt;p&gt;FIDO (Fast IDentity Online) alliasen er en rekke organisasjoner som samarbeider ved å utvikle en sikrere og enklere måter å autentisere på. Denne gruppen kom med FIDO2 standarden som var et utvidelse av det eksisterende rammeverket som de hadde laget men skulle tilby sikker autentisering basert på passordløs autentisering både for mobile og vanlige arbeidsstasjoner.&lt;/p&gt;
&lt;p&gt;FIDO2 Består av to standard hoved komponenter&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Et Web API (WebAuthn)&lt;/li&gt;
&lt;li&gt;Client Authentication Protocol (CTAP)
CTAP definerer protokollen for en ekstern sikkerhetsnøkkel og snakker med en klientenhet. Begge disse er tett ingrert å leverer med det en passordløs pålogging mekanisme.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/fido1.png&#34; alt=&#34;FIDO2&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;For å kunne benytte seg av FIDO2 standarden er man avhengig av å ha støtte for WebAuth og CTAP protokollen på underliggende systemer som f.eks identitetstjenesten, nettleseren og ikke minst operativsystemet for å kunne håndtere autentiseringsmekanismen. Så hvem støtter FIDO2 standarden?&lt;/p&gt;
&lt;p&gt;De fleste moderne nettlesere støtter FIDO2 standarden mot Azure Active Directory med ulike CTAP støtte som USB, NFC eller Bluetooth (BLE)&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/browserfido.png&#34; alt=&#34;browserfido&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;I tillegg må man ha FIDO2 godkjente sikkerhetsnøkler fra en supportert leverandør. Som disse leverandørene her som tilbyr en rekke sikkerhetsnøkler som kommer med ulike funksjonalitet som f.eks Yubiko som leverer USB/NFC nøkler med touch-basert autentisering. Men de fleste leverandørene har ulike alternativer basert på ulik USB(A/C) format&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Feitian&lt;/li&gt;
&lt;li&gt;Kensington&lt;/li&gt;
&lt;li&gt;Thales&lt;/li&gt;
&lt;li&gt;Thetis&lt;/li&gt;
&lt;li&gt;Token2 Switzerland&lt;/li&gt;
&lt;li&gt;TrustKey Solutions&lt;/li&gt;
&lt;li&gt;Yubico&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;hva-støtter-fido2&#34;&gt;Hva støtter FIDO2?&lt;/h2&gt;
&lt;p&gt;Men hvilken identitetstjenester støtter FIDO2? (Ikke en helt fullstendig liste)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Google Identity&lt;/li&gt;
&lt;li&gt;Azure Active Directory (omfatter og Office 365)&lt;/li&gt;
&lt;li&gt;Okta&lt;/li&gt;
&lt;li&gt;Github&lt;/li&gt;
&lt;li&gt;Buypass ID &amp;amp; Authentication tjenesten (&lt;a href=&#34;https://buypassdev.atlassian.net/wiki/spaces/BFIS/overview&#34;&gt;https://buypassdev.atlassian.net/wiki/spaces/BFIS/overview&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;PingIdentity&lt;/li&gt;
&lt;li&gt;Sosial medier som (Facebook/Twitter)&lt;/li&gt;
&lt;li&gt;Passordtjenester som (1Password, LastPass f.eks)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Det finnes også en fullstendig liste som spesielt Yubikey støtter her &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.yubico.com/no/works-with-yubikey/catalog/?sort=popular&#34;&gt;https://www.yubico.com/no/works-with-yubikey/catalog/?sort=popular&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Selv om ikke alle applikasjoner har innebygget støtte for WebAuth så vil det fungere om applikasjoner og tjenester man benytter seg av er integert mot en av disse identitetstjenestene over som (f.eks AzureAD), betyr det at man kan benytte seg av f.eks passordløs autentisering mot disse tjenestene.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/webauthflow.png&#34; alt=&#34;webauth&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Fra en sluttbruker perspektiv som skal autentisere mot en angitt tjeneste, vil arbeidsflyten være slik.(NB WebAuth er et javascript biblotek som kjører i nettleseren)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0: Bruker går mot angitt applikasjon som krever autentisering, går tilbake til iDP.&lt;/li&gt;
&lt;li&gt;1: Relay party (som er en komponent hos iDPen) sender&lt;/li&gt;
&lt;li&gt;2: Nettleseren sender en authenticatorMakeCredential() som inneholder til authenticator (via CTAP) tjenesten å be brukeren legge inn enten pinkode eller touch&lt;/li&gt;
&lt;li&gt;3: Brukeren verifiserer autentiseringen tilbake til CTAP.&lt;/li&gt;
&lt;li&gt;4: CTAP returnerer data tilbake til nettleseren med en ny credential ID og annen informasjon&lt;/li&gt;
&lt;li&gt;5: Nettleseren sender data tilbake til server (Relay party hos iDPen)&lt;/li&gt;
&lt;li&gt;6: Server godkjenner forespørselen å sender tilbake et access token fra iDPen som gir SSO.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;hvordan-sette-opp-en-passordløs-løsning-med-yubikey&#34;&gt;Hvordan sette opp en passordløs løsning med Yubikey?&lt;/h2&gt;
&lt;p&gt;Oppskriften her er å sette opp dette mot Azure Active Directory. Hvor det første steget er å aktivere FIDO2 som en påloggingsmekanisme i Azure AD. Dette gjøres under Azure AD Properties &amp;ndash;&amp;gt; Security &amp;ndash;&amp;gt; Authentication Methods. Deretter må FODI2 aktiveres.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread1.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Når dette er gjort, men per bruker aktivere nøkkelen for sin bruker. Dette kan gjøres via myapps.microsoft.com å under Security og Sign-ins velge Security information og velge &amp;ldquo;Add Method&amp;rdquo;. Under der vil man ha valg om å legge til Security Key.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread2.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å deretter velge hva slags type nøkkel man har. I eksempelt her har jeg en Yubikey v4 som kun er støtte via USB.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread3.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Når man velger nøkkeltype, vil iDP tjenesten trigger autentiseringsflyten via WebAuthn som vil kjøre registrering av nøkkelen. Så vil man se en typisk bilde som dette for å registrere nøkkelen sin.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread4.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Når dette er gjort, vil man også avhengig av type nøkkel fullføre en autentiseringsprosess enten ved å legge inn pinkode eller touch basert autentisering&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread5.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Når dette er gjort vil man via Azure AD login som dekker O365 og andre tjenester ha &amp;ldquo;Sign in with a Security Key&amp;rdquo; som opsjon. Pinkode i tilfelle ved logging vil være andre faktoren som oppfyller kravene til MFA.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/azuread6.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Det skal også sies at samme autenseringsmekanisme er også tilgjengelig direkte mot Windows. Som krever at Windows Hello For Business er aktivert.
I prinsippet så har Microsoft integert CTAP komponenten inn i sitt operativsystem for å få til dette. Om klienten også er en del av Azure AD vil man også kunne få SSO fra Windows login ut til alle tjenester som er integrert mot iDP tjenesten.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/windows10.png&#34; alt=&#34;azuread1&#34;  /&gt;
&lt;/p&gt;
&lt;h2 id=&#34;hensyn-man-må-ta-om-man-setter-dette-opp-for-windows-infrastruktur&#34;&gt;Hensyn man må ta om man setter dette opp for Windows infrastruktur&lt;/h2&gt;
&lt;p&gt;Så langt har vi beskrevet oppsettet inn mot en skybasert identitestjeneste, kan dette også virke mot mer tradisjonelle tjenester som Active Directory?
Det er også supportert men krever noe modifikasjoner mot Active Directory som beskrives her &amp;ndash;&amp;gt; &lt;a href=&#34;https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-authentication-passwordless-security-key-on-premises&#34;&gt;https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-authentication-passwordless-security-key-on-premises&lt;/a&gt; (men merk det krever fortsatt at man har identitet synkronisert ut mot Azure Active Directory)&lt;/p&gt;
&lt;p&gt;Men det er viktig å påpeke at denne tjenester er ikke supportert mot alle protokoller som f.eks RDP eller &amp;ldquo;Run-as&amp;rdquo; eller pålogging mot servere via WMI/PowerShell.&lt;/p&gt;
&lt;h2 id=&#34;er-vi-tryggere-nå&#34;&gt;Er vi tryggere nå?&lt;/h2&gt;
&lt;p&gt;Er man tryggere når en bruker ikke lengre vet sitt eget passord? Om en bruker ikke lengre har tilgang til sitt eget passord betyr det også at man ikke kan oppgi denne type informasjon som også gjør at man blir mindre sårbar for brukerinformasjon som er på avveie. Alikevel vil ikke f.eks implementering av slike løsniger forhindre at brukernavn og passord kan komme på avveie alikevel. Selv om brukeren bruker en FIDO2 basert nøkkel for passordløs autensering så sitter fortsatt passordet lagret hos identitetstjenesten. Eneste måten man da kan forhindre det på er om idenditetsleverandøren tar bort passordet helt fra løsningen, slik som Microsoft har gjort som mulighet for Microsoft online kontoer.&lt;/p&gt;
&lt;p&gt;Samtidig har man også mulighet til å definere sikkerhetsregler som krever f.eks at om man skal kunne logge inn så må man ha nøkkelen for å gjennomføre MFA autentiseringen.&lt;/p&gt;
&lt;p&gt;Om den også skal ha ønsket effektv ved å eliminere passord, må man også se på resten av økosystemet. Hva slags tjenester er det som brukeren har behov/tilgang til som krever passord? mobilen? print systemet? adgangskontroll? Det er selvsagt viktig å vurdere hvordan og hvilken type løsning som passer til det økosystemet man har for å kunne få til en sømløs opplevelse for brukerene.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Hvordan redusere risikoen for å bli utsatt for Ransomware angrep</title>
      <link>https://trusselsky.github.io/posts/ransomware/</link>
      <pubDate>Sat, 18 Sep 2021 23:38:06 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/ransomware/</guid>
      <description>&lt;p&gt;De siste månedene har det vært en voldsom økning knyttet til ransomware angrep, derfor ønsket vi å komme med en den generelle råd i forhold til hvordan man kan redusere risikoen for å bli utsatt for ransomware angrep. NB: Dette er en liste med tiltak som vil bli kontinuerlig oppdatert (19/09/2021)&lt;/p&gt;
&lt;p&gt;Det er viktig å påpeke at ransomware angrep har i det siste også vært mye tidligere ute med å ta i bruk nye sårbarheter. Dette betyr at viktigheten med å få på plass sikkerhetsoppdateringer er essensielt.&lt;/p&gt;
&lt;h2 id=&#34;angrepsvinklene&#34;&gt;Angrepsvinklene&lt;/h2&gt;
&lt;p&gt;De siste årene har ransomware aktørene endret taktikk i forhold til hvordan ransomware angrep blir gjennomført. Ransomware angrep forekommer ofte i to ulike varianter.&lt;/p&gt;
&lt;h3 id=&#34;ddos-ransomware-angrep&#34;&gt;DDoS Ransomware angrep&lt;/h3&gt;
&lt;p&gt;som omhandler at en organisasjon blir utsatt for distribuert angrep mot eksterne tjenester eller mot datasenteret med ofte veldig store mengder data som gjør det vanskelig å håndtere. Senest i sommer kom det frem at en organisasjon ble utsatt for en DDoS angrep som ble målt opp til 17 millioner forespørsler per sekund. Når disse angrepene forekommer vil ofte de som fasiliterer angrepet sende epost til IT-kontaktene i organisasjonen å deretter be om løsepenger eller så vil angrepet øke i omfang og lengde.&lt;/p&gt;
&lt;h3 id=&#34;kryptering-ransomware-angrep&#34;&gt;Kryptering ransomware angrep&lt;/h3&gt;
&lt;p&gt;som omhandler at en organisasjon blir utsatt for angrep hvor hackerene ofte vil gjøre data utilgjengelig ved å kryptere informasjon/data de har tilgang til. Dette er den vanligste angrepsformen, men vi ser nå i det siste så har også hackerene endret taktikk til at det også gjør flere ting for å øke sannsynligheten for at løsepenger blir betalt.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Henter ut data og lagrer på sine egne servere og deretter kjører omvendt auksjon - ergo organisasjonen må by på sine egne filer og data eller så blir informasjon publisert ut mot internett&lt;/li&gt;
&lt;li&gt;Truer med å kontakte media, samarbeidspartnere eller sluttkunder av organisasjonen. Om de har sensitive opplysninger om enkeltpersoner eller andre foretak som de har tilgang til vil de også bruke dette for å eventuelt true disse individene også.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Denne angrepsformen er ofte gjennomført eller starter via&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Phising angrep mot sluttbrukere&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Feilkonfigurert infrastruktur (som f.eks tjenester som er eksponert ut mot Internet uten noen sikkerhetsmekanismer)&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Sårbarheter&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Gjenbruk av identitet&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Når en eventuelt hacker har fått tilgang til en kompromitert klient eller via en sårbar tjenester så vil de benytte ulike mekanismer for å komme lengre innover i infrastrukturen. Veldig ofte hvor hackere har greid å gjennomføre angrep hvor de tilslutt har greid å gjøre all infrastruktur utilgjengelig er det ofte enkle ting som har vært den utløsende faktoren. Ofte ser vi at det er tjenester som er sårbare hvor leverandøren har hatt sikkerhetsoppdatering tilgjengelig lenge eller bare dårlig sikkerhetshygine, eller en kombinasjon av begge deler.&lt;/p&gt;
&lt;h2 id=&#34;tiltak&#34;&gt;Tiltak&lt;/h2&gt;
&lt;p&gt;Her vil vi gå overordent igjennom en del tiltak som man bør ha gjennomført for å redusere risikoen tilknyttet ransomware. Et viktig element som er viktig å forstå er at ransomware utnytter i prinsippet alltid de svakeste leddene i en IT infrastruktur så derfor er det viktig å ha kontinuerlig forbedringer og jobbe systematisk med sikkerhet.&lt;/p&gt;
&lt;h3 id=&#34;identitet&#34;&gt;Identitet&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Definere en strengere passord policy som angir at passord bør være melom 15 - 20 bokstaver som ikke bør inneholde ord som kommer fra typisk ordbok som gjør at det man være enkelt å kjøre brute-force angrep. Samtidig bør også varigheten på settes til at den ikke utløper eller så lenge som mulig. Det er derimot viktigere å ha MFA mekanismer på toppen. Tjenester som Azure AD Password Protection kan brukes for unngå at noen bruker standard ord som en del av passordene sine.&lt;/li&gt;
&lt;li&gt;Definere MFA for all tilgang. Tjeneste som Windows Hello for Business, eller tjenester som støtter SAML/OAuth bør brukes for tjenester for å kunne gi MFA kombinert med SSO for tilgang til tjenester. SAML/Oauth bør også brukes for å etablere integrasjoner mot andre SaaS tjenester slik at man så få brukerkontoer som mulig fra en brukerkontekst.&lt;/li&gt;
&lt;li&gt;Bruk tjenester som Azure AD Identity Protection, Haveibeenpwnd.com eller f-secure identity protection for å overvåkning på sluttbrukerens identitet. Disse tjenestene kan gi indikasjon på om bruker informasjon er på avveie eller brukerkontoer har blitt kompromitert via en hacket 3.parts tjeneste.&lt;/li&gt;
&lt;li&gt;Om man har Azure AD Connect sett på password hash sync (om det ikke er aktivert) dette vil også gjøre at Microsoft kan sammenligne hash med informasjon som sikkerhetsforskerene der finner på kompromiterte 3.parts sider å kan informere om bruker informasjon er på avveie.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sårbarheter&#34;&gt;Sårbarheter&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Sårbarheter er noe som blir funnet kontinuerlig, enten det er da sårbarheter i kjente produkter som Windows eller om det er sårbarheter tilknyttet egenutviklet tjenester. Ofte handler det om å ha automatisert oppdateringsmekanismer på plass som en sentralisert. Ofte er dette f.eks WSUS for Windows infrastruktur eller Windows Update for Business for klient via Intune eller Red Hat Satellite for Linux infrastruktur. Men utfordringen er 3.parts tjenester som ikke blir dekket av de sentralisrte patchesystemene. Da må man enten benytte 3.parts tjenester som Qualys eller Rapid7 produkter for å få kontinuerlig informasjon om sårbarheter. Eller at man må kontinuerlig overvåke applikasjonslandskapet å følge med på sikkerhetspatcher som kommer fra leverandørene. Man kan også se her for en kompilert liste over standard sårbarheter ransomware aktører har utnyttet de siste årene &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.bleepingcomputer.com/news/security/researchers-compile-list-of-vulnerabilities-abused-by-ransomware-gangs/&#34;&gt;https://www.bleepingcomputer.com/news/security/researchers-compile-list-of-vulnerabilities-abused-by-ransomware-gangs/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;nettverk&#34;&gt;Nettverk&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Forsikre dere om at ingen unødvendige tjenester er eksponert ut. Mange ransomware angrep starter som oftest av maskiner som blir kompromiterte som er feil konfigurert som f.eks en Windows Server med RDP som er aktiv.&lt;/li&gt;
&lt;li&gt;For tjenester som er eksponert pass på at kun godkjente tjenester er tilgjengelige, slik at tjenester som f.eks SMB (filtrafikk) er tilgjengelig ut mot Internett.&lt;/li&gt;
&lt;li&gt;Om tjenester som RDP skal være tilgjengelig eksternt må det være MFA tjenester på plass.&lt;/li&gt;
&lt;li&gt;Om man driver med ecommerence eller nettshop løsning, se på desentralisert brannmur tjenester for å forhindre at DDoS trafikk blir rutet mot eget datasenter eller mot hosting leverandør.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;klienter&#34;&gt;Klienter&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Definere en standard Group Policy for hvilken standard applikasjoner som skal brukes for åpning av filer som HTA, JS eller lignende. Norsk Helsenett har definert en standard liste som er grei å følge &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.nhn.no/Personvern-og-informasjonssikkerhet/helsecert/anbefalte-sikkerhetstiltak/blokkering-av-script-og-programfiler&#34;&gt;https://www.nhn.no/Personvern-og-informasjonssikkerhet/helsecert/anbefalte-sikkerhetstiltak/blokkering-av-script-og-programfiler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Macroer tilknyttet Microsoft Office bør deaktiveres eller begrenset kun til å kjøre fra godkjente lokasjoner. Finnes også en rekke tiltak her som bør følges &amp;ndash;&amp;gt; &lt;a href=&#34;https://adsecurity.org/?p=3299&#34;&gt;https://adsecurity.org/?p=3299&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Benytt tjenester som Identity Guard (Benyttes for å forhindre lesetilgang til LSASS som typisk brukes for å hente ut lokal brukerdatabase) Application Guard (Gjør at tjenester som Microsoft Edge, Office kan kjøres i en egen container som er isolert fra resten av operativsystemet)&lt;/li&gt;
&lt;li&gt;Fjern at brukeren kjører som lokal administrator, ha eleveringsmulighet med f.eks bruk av &lt;a href=&#34;https://github.com/pseymour/MakeMeAdmin/wiki&#34;&gt;https://github.com/pseymour/MakeMeAdmin/wiki&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Forsikre seg om at tjenester som antivirus og (eventuelt EDR) tjenester er innstallert og oppdatert på alle klienter. (Her er en god oversikt på gode antivirus leverandører &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.av-comparatives.org/tests/real-world-protection-test-july-august-2021-factsheet/&#34;&gt;https://www.av-comparatives.org/tests/real-world-protection-test-july-august-2021-factsheet/&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Om man bruker Microsoft Edge eller Google Chrome ha Password Monitoring aktivert i nettleseren.&lt;/li&gt;
&lt;li&gt;Ha regelsett på plass for nettleseren via Group Policy for å forhindre at det ikke er tillatt å surfe på nettsider med et self-signed sertifikat. Samt verifisere at Safe Browsing og Smartscreen filter er aktivert.&lt;/li&gt;
&lt;li&gt;Tilby login via bruk av tjenester som Windows Hello for Business eller tjenester som støtter WebAuth ved login som gjør at man kan logge inn med bruk av f.eks hardware nøkler som Yubikey.&lt;/li&gt;
&lt;li&gt;Ha utvidelser eller extensions som blokkerer pop-ups.&lt;/li&gt;
&lt;li&gt;Flytt klienten ut av Active Directory og ut til Azure Active Directory. All ransomware kode som er laget i dag som tar utgangspunkt i en kompromitert klient er laget for å deretter bevege seg videre innover i infrastrukturen via Active Directory. Ved å flytte klienten ut til Azure AD tar man i prinsippet bort denne muligheten. Det samme prinsippet gjelder for Chromebooks/tynnklienten hvor det er liten til null sjans for å kompromitere endepunktet.&lt;/li&gt;
&lt;li&gt;Bruk Attack Surface Reduction rules til å aktivere regelsett mot at Microsoft Office skal få lov til å starte &amp;ldquo;child processes&amp;rdquo; som var utnyttet i forbindelse med siste MSHTML sårbarhet.&lt;/li&gt;
&lt;li&gt;Deaktiver autorun&lt;/li&gt;
&lt;li&gt;Eventuell tilgang til sentrale tjenester bør følge et zero-trust prinsipp. Hvor ihvertfall bruker og enhets kontekst bør evalueres før tilgang gis. Som f.eks via Conditional Access.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;epost&#34;&gt;Epost&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Forhindre mottak av filer med spesifkke filtyper. (&lt;a href=&#34;https://docs.microsoft.com/en-us/exchange/troubleshoot/email-delivery/how-to-block-message-from-being-sent-or-received&#34;&gt;https://docs.microsoft.com/en-us/exchange/troubleshoot/email-delivery/how-to-block-message-from-being-sent-or-received&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;windows-infrastruktur&#34;&gt;Windows Infrastruktur&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Slå av bruk av eldre versjoner av SMB fil protokollen. Mange har oppgraderte Windows fil servere som i mange sammenhenger fortsatt har eldre versjoner av SMB som har en del sårbarheter. Disse bør skrus av/deaktivere å man bør passe på at kun SMB 3 er mulig å bruke.&lt;/li&gt;
&lt;li&gt;Aktiver SMB Signing - Dette gjøres via Group Policy&lt;/li&gt;
&lt;li&gt;Avinnstaller eldre versjoner av PowerShell. PowerShell kan ha flere versjoner innstallert samtidig. Mange Ransomware script prøver å kjøre via PoewrShell v1 pga mangel av logging og sikkerhetsmekanismer. Verifiser at siste versjon er tilgjengelig på Windows Servere. Det bør ihvertfall være fra versjon 5 og oppover innstallert.&lt;/li&gt;
&lt;li&gt;Forsikre også at PowerShell har script block aktivert, samt transaksjons logging slik at man kan logge all bruk av PowerShell.&lt;/li&gt;
&lt;li&gt;Innstallere Windows LAPS (Local Administrator Password Solution) dette for å automatisk rotere lokal administrator passord på maskinene.&lt;/li&gt;
&lt;li&gt;Definer Group Policy for å skru på &amp;ldquo;Deny log on trough Remote Desktop Services&amp;rdquo; Mange ransomware aktører benytter RDP for å logge på andre servere i infrastrukturen, ved å angi denne group policyen kan man begrense hvilken kontoer som får lov til å logge på miljøet.&lt;/li&gt;
&lt;li&gt;Slå av Widows tjenester som ikke skal brukes på aktuelle servere. Som f.eks domene kontrollere har ikke behov for Print Spooler tjenesten å bør skrus av der.&lt;/li&gt;
&lt;li&gt;Om man benytter noen provisjoneringstjeneste for enten Citrix eller templates for VMware, er det viktig å ha en rutine på plass for å huske å oppdatere image jevnlig med de siste sikkerhetsoppdateringene.&lt;/li&gt;
&lt;li&gt;Unngå helst bruk av tradisjonell RDP som managmenet løsning, men om det kreves bruk ihvertfall Remote Credential Guard for å unngå eventuelle pash-the-hash angrep. Eller bruk av Protected Privileged Accounts som krever domene nivå satt til 2012 R2 men forhindrer at man kan logge inn med NTLM eller delegert tilgang.&lt;/li&gt;
&lt;li&gt;Sett antall cached credentials til null (med mindre det er et Citrix miljø)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;skytjenester&#34;&gt;Skytjenester&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;For SharePoint/Onedrive definer policier hvor man angir godkjente filtyper som kan synkroniseres via OneDrive. (Set-SPOTenantSyncClientRestriction -ExcludedFileExtensions « exe;js;hts&amp;quot;)&lt;/li&gt;
&lt;li&gt;Ha Conditional Access regelsett på plass som deaktiverer legacy protokoller i Azure AD.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;generelle-tiltak&#34;&gt;Generelle tiltak&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Backup tjenesten bør være frakoblet fra virtuell infrastruktur samt Active Directory. I mange sammenhenger har vi sett at backup data har blitt kryptert sammen med resten av infrastrukturen. Man bør redusere risikoen for at backupen blir infisert derfør bør backup løsningen kjøre isolert med egne brukeridentitet.&lt;/li&gt;
&lt;li&gt;Følge 3-2-1 reglene i forhold til backup. At man har 3 kopier av data (produksjonsdata samt 2 backup kopier) på 2 ulike medier samt med en kopi offiste.&lt;/li&gt;
&lt;li&gt;Verifiser backup dataene ofte, har rutiner på plass. Samt at flere backup levernadører kan nå tilby automatisert sjekk av data som bør settes opp som en automatisert jobb.&lt;/li&gt;
&lt;li&gt;Bruk immutable backup data om mulig. Dette forhindrer at ransomware aktører kan overskrive backup data (ved å f.eks kryptere innholdet) men krever at man har en backup leverandør som supporterer dette.&lt;/li&gt;
&lt;li&gt;Eksterne web-tjenester hvor man er usikker på angrepsflaten bør plasseres bak en WAF (Web Application Firewall) tjeneste.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;data-og-informasjon&#34;&gt;Data og informasjon&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Se på mulighet for kryptering av sensitiv data. F.eks filer som databaser eller filer som inneholder sensitiv informasjon bør krypteres med type DLP tjenester for å unngå at informasjon kommer på avveie. Flere tjenester er tilgjenglig til f.eks SQL Server som kan kryptere informasjon slik data ikke kan leses direkte selv om uvedkommende har fått tak i data filene til databasen. Det finnes også tjenester som kan automatisk klassifisere og kryptere data basert på innhold som f.eks Microsoft AIP.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;overvåkning&#34;&gt;Overvåkning&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ha en sentralisert loggingstjeneste for overvåkning av bruker aktivitet. Viktige elementer og eventIDer som man bør følge med på er (Event ID 4625 (Failet pålogging), 4740 (konto last ute) eller 1102 (Event Cleared) her er også en kompilert liste over eventer man bør ha aktivert &amp;ndash;&amp;gt; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/audit-policy-recommendations&#34;&gt;https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/audit-policy-recommendations&lt;/a&gt;. For sentralisert overvåkning kan man benytte Windows Event Forwarding, SCOM Audit Collector, Splunk, ELK eller skytjenester som Azure Sentinel.&lt;/li&gt;
&lt;li&gt;Prosess overvåkning - Mange ransomware aktører bruker også tjenester som Anydesk, Teamviewer, Bloodhound, PSEXEC og annet for å kartlegge eller ha en enkel måte å gi tilgang til infrastrukturen på. Se på muligheten for å få sentralisert overvåkning på disse angitte prosessene som kan enten gjøres via EDR verktøy eller bruk av Sysmon fra Sysinternals pakken å deretter definere overvåknignsregler.&lt;/li&gt;
&lt;li&gt;Ha DNS Overvåkning - Man kan også forhindre og blokkere phising angrep, eller at tjenester prøver å oppnå kommunikasjon tilbake til noen Command og Control tjenester ved å forhindre dette på DNS nivå. Det finnes DNS tjenester som kan brukes som f.eks Cloudflare for Teams, Cisco Umbrella som forhindrer DNS oppslag mot mistenkelig DNS domener. Samtidig bør man også ha DNS overvåkning på plass for å kunne se etter mistenkelig domener som det har blitt gjort oppslag mot.&lt;/li&gt;
&lt;li&gt;Flere ransomware aktører benytter nå også nyere protokoller for innhenting av script og annen payload via tjenester som f.eks HTTP/3 som i dag effektivt ikke kan inspiseres via brannmur eller proxy tjenester. Man bør også ha en EDR/XDR tjenester på sluttbrukerens maskiner for å kunne se på nettverksflyten.&lt;/li&gt;
&lt;li&gt;Logg trafikk også tilknyttet TerminalServices-RemoteConnectionManager samt Security og SMB loggene jevnlig for å se etter unormal aktivitet.&lt;/li&gt;
&lt;/ul&gt;
</description> 
    </item>
    
    <item>
      <title>DDoS angrep og trender fremover</title>
      <link>https://trusselsky.github.io/posts/merddos/</link>
      <pubDate>Tue, 24 Aug 2021 08:16:36 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/merddos/</guid>
      <description>&lt;p&gt;Tidligere i sommer stoppet Cloudflare det som er beskrevet som det største DDoS angrepet noensinne, med lit over 17.2 millioner forespørsler-per-sekund over HTTP trafikk (som ofte gjøres for å kamuflere angrepet som mer legitim trafikk). Til sammenligning så håndterer Cloudflare som i dag leverer cirka 13% av all HTTP trafikk på verdensbasis, ca 25 millioner forespørsler-per-sekund. Motivet bak å kjøre DDoS angrep er for å kunne gjøre tjenester utilgjengelig eller for å ta ned infrastruktur med å overbelaste systemene.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/ddos.jpg&#34; alt=&#34;ddos&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Ofte kjøres slike angrep fra kontrollerte Botnet. Som er maskiner som er infisert med malware som igjen blir styrt av en Botnet Operatør for å kunne utføre DDoS angrep.&lt;/p&gt;
&lt;p&gt;Samtidig kan vi også se at det skjer flere DDoS mot Norge organisasjoner, som man kan se mer info av her &amp;ndash;&amp;gt; (&lt;a href=&#34;https://radar.cloudflare.com/no&#34;&gt;https://radar.cloudflare.com/no&lt;/a&gt;) som ofte gjøres av ulike årsaker.&lt;/p&gt;
&lt;p&gt;1: For å gjennomføre et ransomware angrep (Enten betaler du X antall kroner eller så vil din tjeneste være utilgjengelig) Dette har vi sett også kan gjøres samtidig som hackere gjør angrep via andre vektorer også. Dette er blant annet noe som ble gjort mot Vinmonopolet i fjor høst &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.digi.no/artikler/hackerne-tok-ned-vinmonopolet-no-i-dag-har-de-varslet-et-mye-verre-angrep/504268&#34;&gt;https://www.digi.no/artikler/hackerne-tok-ned-vinmonopolet-no-i-dag-har-de-varslet-et-mye-verre-angrep/504268&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2: For å gjøre en tjeneste utilgjengelig, enten politisk mål eller andre årsaker.&lt;/p&gt;
&lt;p&gt;Samtidig vil vi se en trend fremover med flere DDoS angrep. Litt av bakgrunn for dette er fordi at flere applikasjoner og tjenester nå bytter gradvis over til å bruke UDP basert transport i stedet for tradisjonelle TCP. Dette da for å kunne redusere latency å andre hopp frem og tilbake på kommunikasjon samt gi en bedre brukeropplevelse på noen tjenester. På toppen av UDP er det flere nå som benytter DTLS som protokoll. DTLS er en protokoll som er hybrid som gir same pålitelighet som TCP men levert via UDP. Spesielt er det tjenester som Citrix HDX, Microsoft RDP samt Zscaler og noen VPN leverandører som DTLS som kommunikasjonsprotoll.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/dtls.jpg&#34; alt=&#34;DTLS&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;En grunn til at dette vil gi flere DDoS angrep er pga hvordan de ulike leverandørene har implementert DTLS protokollen. Som en del av standarden er det en attributt som er angitt i standarden som en opsjon (å er derfor ikke nødvendig). Denne atributten gjør at om noen initierer et angrep mot en tjeneste via DTLS, vil tjeneren svare med en Cookie under (HelloVerifyRequest) for å forsikre seg om at kommunikasjonen kommer fra en legitim klient, den kommunikasjon blir etablert. For tjenester som ikke har implementert denne attributten på tjenester som bruker DTLS vil angripere i visse sammenhenger kunne utnytte dette for et omvendt DDoS angrep.&lt;/p&gt;
&lt;p&gt;De siste årene har det vært en svakhet som har kommet frem både fra Microsoft RDP (via RD Gateway) og Citrix NetScaler ADC (for Citrix sesjoner) du kan også lese en eldre artikkel her fra Palo Alto om problematikken som var tidligere på Microsoft &amp;ndash;&amp;gt; &lt;a href=&#34;https://unit42.paloaltonetworks.com/dtls-vulnerabilities-cve-2014-6321/&#34;&gt;https://unit42.paloaltonetworks.com/dtls-vulnerabilities-cve-2014-6321/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Den andre utfordringen er at mer og mer av vanlig web trafikk beveger seg over til å bruke HTTP/3 som nå begynner å bli ferdig som en standard. Statistikk som man kan se her, så er cirka 10% av all trafikk som går mot Norske sider via Cloudflare basert på HTTP/3 &amp;ndash;&amp;gt; &lt;a href=&#34;https://radar.cloudflare.com/no&#34;&gt;https://radar.cloudflare.com/no&lt;/a&gt; du kan også lese mer om HTTP/3 her &amp;ndash;&amp;gt; &lt;a href=&#34;https://trusselsky.no/posts/http3ogfremtiden/&#34;&gt;https://trusselsky.no/posts/http3ogfremtiden/&lt;/a&gt;
Utfordringen ligger i trafikk inspeksjon. Mange av dagens brannmur/sikkerhetstjenester er avhengig av å kunne inspisere trafikken for å kunne avdekke angrep eller skadelig innhold. Med HTTP/3 så er det ikke mulig å få direkte inspeksjon av innholdet å derfor vil det vær enklere for angripere å kunne kamuflere innholdet når de gjennomfører et angrep. Samtidig så legger HTTP/3 mer trykk på serveren i form av ressurser for å håndtere kommunikasjonen, som gjør også at et DDoS angrep via HTTP/3 vil ikke kreve like mye trafikk for å kunne ta ned en tjeneste.&lt;/p&gt;
&lt;p&gt;Heldigvis har vi ennå ikke sett store angrep som har blitt gjort via HTTP/3, men basert på trenden vil nok dette også øke fremover &amp;ndash;&amp;gt; &lt;a href=&#34;https://blog.cloudflare.com/ddos-attack-trends-for-2021-q2/&#34;&gt;https://blog.cloudflare.com/ddos-attack-trends-for-2021-q2/&lt;/a&gt; som man må være varsom til nettverksaktivitet mot eksterne tjenester. Spesielt om man som virksomhet leverer f.eks nettbutikker kan man være veldig utsatt for slike angrep.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Poly Network hacket, 600 millioner dollar tatt</title>
      <link>https://trusselsky.github.io/posts/polynetworkshack/</link>
      <pubDate>Wed, 11 Aug 2021 00:31:36 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/polynetworkshack/</guid>
      <description>&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/polyhack.JPG&#34; alt=&#34;HTTP3&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Det ble kjent tidligere i dag, at en av de store DeFi platformene Poly Network ble hacket via en svakhet i en mekanisme som kalles for EthCrossChainManager som brukes for validering på tvers av ulike blockchain prosjekter. Hvor da angriperne overførte 610 millioner dollar til 3 ulike addresser fordelt på ulik valuta.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$273M Ethereum&lt;/li&gt;
&lt;li&gt;$253M Binance Smart Chain&lt;/li&gt;
&lt;li&gt;$85M Polygon&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Man kan se hele analysen av sårbarheten av angrepet her &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Poly has this contract called the &amp;quot;EthCrossChainManager&amp;quot;. It&amp;#39;s basically a privileged contract that has the right to trigger messages from another chain. It&amp;#39;s a pretty standard thing for cross-chain projects.&lt;/p&gt;&amp;mdash; God-like Natural Number Creator Person (TM, R) (@kelvinfichter) &lt;a href=&#34;https://twitter.com/kelvinfichter/status/1425217047898869762?ref_src=twsrc%5Etfw&#34;&gt;August 10, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Når en av de som gjennomføre angrepet skulle prøve å overføre med USDT TOKEN, ble han tipset av noen andre at han ikke måtte bruke det for da ble han svartlistet. Da fikk vedkommende som tipset dem om det overført 13.37 Ether samtidig også startet en strøm av flere folk som ønsker at hackeren skal overføre beløp til dem også (&lt;a href=&#34;https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f&#34;&gt;https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f&lt;/a&gt;) som man også kan se her at felre etterspør valuta &amp;ndash;&amp;gt; &lt;a href=&#34;https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963&#34;&gt;https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Klikk videre for å se hele analysen. Her kan man også se status knyttet til undersøkelsen fra Poly Network selv.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Assets involved include &lt;a href=&#34;https://twitter.com/search?q=%24DAI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$DAI&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24UNI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$UNI&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24SHIB&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$SHIB&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24FEI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$FEI&lt;/a&gt;.&lt;br&gt;ETH:0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963&lt;br&gt;&lt;br&gt;We call on miners of affected blockchain and crypto exchanges to blacklist tokens coming from the above addresses. &lt;a href=&#34;https://twitter.com/MakerDAO?ref_src=twsrc%5Etfw&#34;&gt;@MakerDAO&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Uniswap?ref_src=twsrc%5Etfw&#34;&gt;@Uniswap&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Shibtoken?ref_src=twsrc%5Etfw&#34;&gt;@Shibtoken&lt;/a&gt; &lt;a href=&#34;https://twitter.com/feiprotocol?ref_src=twsrc%5Etfw&#34;&gt;@feiprotocol&lt;/a&gt;&lt;/p&gt;&amp;mdash; Poly Network (@PolyNetwork2) &lt;a href=&#34;https://twitter.com/PolyNetwork2/status/1425091995911995405?ref_src=twsrc%5Etfw&#34;&gt;August 10, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Noe av valutaen er nå fryst, mer info følger.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>ProxyShell - Nye sårbarheter mot Exchange</title>
      <link>https://trusselsky.github.io/posts/proxyshellexchange/</link>
      <pubDate>Mon, 09 Aug 2021 16:44:01 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/proxyshellexchange/</guid>
      <description>&lt;p&gt;Under årets BlackHat Conference, ble det presentert detaljer rundt nye sårbarheter som ble kjent i Microsoft Exchange som nå har blitt dubbet til &amp;ldquo;ProxyShell&amp;rdquo; som er en kombinasjon av 3 sårbarheter.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-34473&lt;/strong&gt; - Pre-auth Path Confusion leads to ACL Bypass (Fikset i April av KB5001779)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-34523&lt;/strong&gt; - Elevation of Privilege on Exchange PowerShell Backend (Fikset i April av KB5001779)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-31207&lt;/strong&gt; - Post-auth Arbitrary-File-Write leads to RCE (Fikset i Oppdatering i Mai av KB5003435)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Sårbarhetene kan gjøre at uvedkommende kan få tilgang til Exchange løsningen å laste ned epost databaser som da inneholder alt av f.eks epost kontoer (epost, kalender,kontakter osv) siden tilgangen som uvedkommende får ved å utnytte sårbarhetene er lokal system.&lt;/p&gt;
&lt;p&gt;Viktig at man dobbeltsjekker hvilken versjon man er på &amp;ndash;&amp;gt; &lt;a href=&#34;https://exchangeserverversions.blogspot.com/2016/01/exchange-server-2016.html&#34;&gt;https://exchangeserverversions.blogspot.com/2016/01/exchange-server-2016.html&lt;/a&gt; (Her er en liste for Exchange 2016)&lt;/p&gt;
&lt;p&gt;MERK: Dette er ikke samme sårbarhet som ble utnyttet i angrepet mot Stortinget som også benyttet en sårbarhet mot Exchange, som heter ProxyLogin.&lt;/p&gt;
&lt;p&gt;Disse sårbarhetene ble presentert av sikkerhetsforsker Orange Tsai (&lt;a href=&#34;https://twitter.com/orange_8361&#34;&gt;https://twitter.com/orange_8361&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Du kan se presentasjonen her &amp;ndash;&amp;gt; &lt;a href=&#34;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf?fbclid=IwAR2V0-4k2yb8dmPP5Mksd8iHYTOfE6sBwygMt4wjq3M9be8Tw6TlH0andhA&#34;&gt;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf?fbclid=IwAR2V0-4k2yb8dmPP5Mksd8iHYTOfE6sBwygMt4wjq3M9be8Tw6TlH0andhA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Her kan man også se et video eksempel hvor noen har laget script som utnytter alle sårbarhetene for å kunne ekspotere epost fra Exchange serveren.&lt;/p&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/LbIYPFrltdA&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt;&lt;!-- raw HTML omitted --&gt; Samtidig kan man også se at bare i Norge er det i overkant av 100+ som har offentlige Exchange servere som fortsatt er sårbare.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/proxyshell.jpg&#34; alt=&#34;ProxyLogin&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Samtidig er det flere nå som merker økt Exchange trafikk, i tillegg er det noen angripere nå som allerede har begynt å utnytte sårbarhetene.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;My Exchange honeypot has somebody dropping files and executing commands. &lt;a href=&#34;https://t.co/pMVsl7y4iy&#34;&gt;https://t.co/pMVsl7y4iy&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kevin Beaumont (@GossiTheDog) &lt;a href=&#34;https://twitter.com/GossiTheDog/status/1423764613829701632?ref_src=twsrc%5Etfw&#34;&gt;August 6, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;h2 id=&#34;indikatorer&#34;&gt;Indikatorer&lt;/h2&gt;
&lt;p&gt;Flere som scanner nå etter sårbare Exchange servere prøver å utnytte sårbarheten via Autodiscovery bibloteket på CAS serverene.
Et eksempel som har blitt flagget er trafikk mot&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://exchange-server/autodiscover/autodiscover.json?@abc
.com/owa/?&amp;amp;Email=autodiscover/autodiscover.json%3F@abc.com 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Om din Exchange løsning fortsatt er sårbar vil den respondere med en HTTP 302 kode tilbake.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>HTTP/3 og fremtidens websikkerhet</title>
      <link>https://trusselsky.github.io/posts/http3ogfremtiden/</link>
      <pubDate>Thu, 05 Aug 2021 21:56:46 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/http3ogfremtiden/</guid>
      <description>&lt;p&gt;Arbeidsgruppen i IETF begynner å komme i mål med HTTP/3 standarden som vil påvirke både ytelsen og sikkerheten på all nett-trafikk, så hva er de viktigste endringene å hvordan påvirker det også sikkerheten?&lt;/p&gt;
&lt;h2 id=&#34;historien-så-langt&#34;&gt;Historien så langt&lt;/h2&gt;
&lt;p&gt;Det skjer for tiden veldig mye utvikling på teknologifronten når det gjelder web og hvordan vi kommuniserer med netttjenester.
Når man åpner en nettleser mot f.eks vg.no vil enhenten du sitter på benytte en rekke nettverksprotokoller for å kommunisere med VG sin infrastruktur.&lt;/p&gt;
&lt;p&gt;Protokollen som benyttes i bunn på nettleser trafikk er HTTP. HTTP har eksistert lenge og majoriteten av nettlesern trafikken i dag benytter HTTP 1.1 protokollen (som har eksistert siden 90-tallet).
Problemet med den protokollen var (og er) all trafikk blir sendt i klartekst, derfor måtte man lage en ny versjon av denne protokollen som her HTTPS som krypterer innholdet mellom tjenester og enhet. Her benyttet man til og begynne med SSL og deretter TLS protokollen som krypteringsprotokoll for å kryptere innholdet mellom klient og tjener.&lt;/p&gt;
&lt;p&gt;HTTP benytter TCP som kommunikasjonsprotokoll for overføring av data, som også gjør den sårbar for pakketap eller høy latency. Kombinert med TLS kommunikasjonen fører til høyere tid mellom klient og tjenester for å få etablert kommunikasjon.&lt;/p&gt;
&lt;p&gt;HTTP 1.1 som protokoll har også en del svakheter blant annet at den ikke støtter multiplexing på en god måte som gjør at HTTP trafikk som kommer fra ulike tjenere må vente i tur. Samtidig med f.eks HTTP/2 kom de også med multiplexing som gjør at man ikke får dette problemet. Samtidig introduserte de også blant annet HPACK (Header Compression) som gjør at man reduserer båndbredden.&lt;/p&gt;
&lt;p&gt;Når HTTP/2 standarden kom valgte også flere leverandører og kreve at all kommunikasjon som skulle støtte HTTP/2 måtte bruke TLS som standard. Som gjorde blant annet f.eks ulike nettlesere som Firefox, Chrome og Edge krever HTTPS når man skal bruke HTTP/2 som protokol.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NB:&lt;/strong&gt; Med TLS 1.3 prøver man å redusere tiden det tar å etablere kommunikasjon mellom klient og tjener ved å benytte. Her ser man en sammenligning mellom TLS 1.2 over HTTP mot TLS 1.3&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/tls12vs13.jpg&#34; alt=&#34;TLS13&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Samtidig som utviklingen har pågått med å prøve å sikre kommunikasjonen (som også i utgangspunktet har ført til tregere kommunikasjon og flere forsinkende ledd) har web utviklingen rast videre, hvor vi nå har mye mer multimedia innhold (bilder,videoer) mye mer 3.parts biblotek og eksterne tjenester. Før var nettleser trafikken mer statisk innhold, hvor det nå har blitt til mye dynamisk innhold og store rammeverk (CMS) med mer multimedia og streaming mekanismer som gjør at man må ha en transport mekanisme som kan overføre data mer effektivt.&lt;/p&gt;
&lt;h2 id=&#34;sikkerhet-og-inspeksjon&#34;&gt;Sikkerhet og inspeksjon&lt;/h2&gt;
&lt;p&gt;Med introduksjon av SSL/TLS krypteringsprotokollene betydde dette at kommunikasjon ble kryptert. (dog dette betyr ikke at innholdet nødvendigvis er trygt)&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;HTTPS &amp;amp; SSL doesn&amp;#39;t mean &amp;quot;trust this.&amp;quot; It means &amp;quot;this is private.&amp;quot; You may be having a private conversation with Satan.&lt;/p&gt;&amp;mdash; Scott Hanselman (@shanselman) &lt;a href=&#34;https://twitter.com/shanselman/status/187572289724887041?ref_src=twsrc%5Etfw&#34;&gt;April 4, 2012&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Med mer ondsinnet trafikk som gikk over nett betydde dette at flere måtte begynne å bruke tjenester for å kunne analysere innholdet (som i dag tilbys av de fleste brannmur/proxy leverandører). Dette  kunne da analysere innholdet etter f.eks ondsinnet trafikk eller beskytte brukere fra ukjente adresser eller annet innhold. Flere leverandører bruker også lignende mekanismer for å kunne kategorisere innhold samt definere hvilken applikasjon/tjeneste som en bruker kobler seg opp i mot. Dette betyr i prinsippet at proxy/brannmur tjenesten dekrypterer innholdet for å kunne &amp;ldquo;se&amp;rdquo; hva som skjer i trafikk strømmen før trafikken blir kryptert igjen og sendt videre, som en type MiTM (Man-in-the-middle) tjeneste.&lt;/p&gt;
&lt;p&gt;Denne mekanismen ble også brukt for lastbalanseringstjenester der man kunne balansere trafikk basert på spesifikt innhold.&lt;/p&gt;
&lt;h2 id=&#34;hvorfor-http3-&#34;&gt;Hvorfor HTTP/3 ?&lt;/h2&gt;
&lt;p&gt;Allerede nå er det mange nettsider/leverandører som har beveget seg videre til HTTP/3, som man ser her så er cirka &lt;strong&gt;13% av all kommunikasjon går via HTTP/3 protokollen&lt;/strong&gt; Som store leverandører som Google, AWS og Cloudflare, mens resten er fordelt på HTTP 1.1 og HTTP/2 (Statistikk fra Cloudflare Radar siste 30 dagene) som også er supportert av de fleste moderne nettlesere.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/http3.jpg&#34; alt=&#34;HTTP/3 Bruk&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Men man ser også at HTTP/3 har vesentlig forbedret tiden det tar både å etablere kommunikasjon samt også hvordan håndtere pakketap.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/http2-http3.png&#34; alt=&#34;HTTP3&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Så er forandret i HTTP/3 ?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I stedet for TCP benytter HTTP/3 seg av QUIC (Quick UDP Internet Connections) som overføringsprotokoll som er bygget på UDP. Men samtidig tilbyr flere av TCP egenskapene som pålitlighet og overbelastingskontroll algoritmer som f.eks CUBIC eller New Reno. (Dette krever dog at UDP/443 er åpnet i brannmuren)&lt;/li&gt;
&lt;li&gt;Benytter seg QPACK for komprimering av HTTP headere (Sammenlignet med HPACK som ble brukt i HTTP/2)&lt;/li&gt;
&lt;li&gt;Krever TLS kryptering for kommunikasjon (Var ikke et krav i HTTP/2, selv om flere leverandører krevde det)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Samtidig er også kryptering som før har blitt håndtert av TLS nå gjort direkte i kommunikasjonsprotokollen som gjør at trafikk inspeksjon som før ble gjort av brannmurer/proxy tjenester ikke lenger er mulig.&lt;/p&gt;
&lt;h2 id=&#34;hvordan-sikre-trafikk-fremover-&#34;&gt;Hvordan sikre trafikk fremover ?&lt;/h2&gt;
&lt;p&gt;Med mer og mer av internett trafikken beveger seg mot bruk av HTTP/3 samtidig som standarden blir ferdigstilt, betyr dette også at flere organisasjoner må ta stilling til hvordan det skal håndtere HTTP/3 trafikken. Flere leverandører nå begynner å komme med støtte for HTTP/3&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Blant annet så kommer nå Microsoft med en ny versjon av SMB som også støtter QUIC (&lt;a href=&#34;https://techcommunity.microsoft.com/t5/itops-talk-blog/smb-over-quic-files-without-the-vpn/ba-p/1183449&#34;&gt;https://techcommunity.microsoft.com/t5/itops-talk-blog/smb-over-quic-files-without-the-vpn/ba-p/1183449&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Google Cloud støtter QUIC (&lt;a href=&#34;https://cloud.google.com/blog/products/networking/cloud-cdn-and-load-balancing-support-http3&#34;&gt;https://cloud.google.com/blog/products/networking/cloud-cdn-and-load-balancing-support-http3&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Citrix ADC Quic (&lt;a href=&#34;https://docs.citrix.com/en-us/citrix-adc/current-release/system/quic.html&#34;&gt;https://docs.citrix.com/en-us/citrix-adc/current-release/system/quic.html&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Akkurat nå er det få til ingen brannmur/proxy leverandører som supporterer inspeksjon av QUIC og HTTP/3 og den generelle anbefalingen er å deaktivere de protokollene i brannmuren, men dette gjør at klientene som sitter på innsiden vil falle tilbake til HTTP 1.1 med TLS. Samtidig beveger flere seg på utsiden av den tradisjonelle brannmuren ved å jobbe fra hjemme eller andre lokasjoner, som gjør at den tradisjonelle brannmuren mister litt av den orginale hensikten ved å beskytte trafikken mellom innsiden og utsiden.&lt;/p&gt;
&lt;p&gt;Derfor vil det være viktig fremover å se på løsninger som gir mer innsikt direkte fra endepunktet perspektivet for å kunne ivareta sikkerhet på samme måte, men samtidig ivareta forbedringene som HTTP/3 kommer med.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Sikring av Kubernetes og tjenester</title>
      <link>https://trusselsky.github.io/posts/sikringavkubernetes/</link>
      <pubDate>Wed, 04 Aug 2021 09:18:38 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/sikringavkubernetes/</guid>
      <description>&lt;p&gt;Flere og flere organisasjoner begynner å ta i bruk Kubernetes som platform for å levere fremtidige microtjenester. Kubernetes er også et veldig komplekst økosystem som kan bestå av mange ulike elementer i forhold til nettverkskontroll, konfigurasjonskontroll og CI/CD blant annet.&lt;/p&gt;
&lt;p&gt;Når man skal designe en Kubernetes platform, bør man ha en god forståelse på hvordan man skal sikre løsningen.  Her vil det ligge lenker og oppdatert informasjon på referanse arkitektur og best-pratices i forhold til sikring av Kubernetes og tjenester.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://dodcio.defense.gov/Portals/0/Documents/Library/DevSecOpsReferenceDesign.pdf&#34;&gt;DoD DevSecOps: Reference Design&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://media.defense.gov/2021/Aug/03/2002820425/-1/-1/1/CTR_KUBERNETES%20HARDENING%20GUIDANCE.PDF?fbclid=IwAR3wywz7qyCtktUgwXAH95zXcFR3lurRXGzkCoQJNQASc4m_JVZk6WmaqmA&#34;&gt;Kubernetes Hardening Guidance&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description> 
    </item>
    
    <item>
      <title>Sårbarhetsscanning med GitHub mot kjente rammeverk</title>
      <link>https://trusselsky.github.io/posts/kodescanninggithub/</link>
      <pubDate>Thu, 29 Jul 2021 13:20:04 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/kodescanninggithub/</guid>
      <description>&lt;p&gt;Den (28/07) Annonserte GitHub at som en del av Code Scanning tjenesten de leverer at de nå har kommet med 15 nye integrasjoner med åpne kildekode rammeverk som dekker rammeverk som Ruby, PHP, Switch, Terraform, PowerShell og Kubernetes YAML.&lt;/p&gt;
&lt;p&gt;Code Scanning funksjonen ble lansert i 2020 som er tilgjengelig for alle offentelige repositories samt for Private repositories (Krever GitHub Advanced) men gjør at man kan se igjennom kildekoden etter sårbarheter.&lt;/p&gt;
&lt;h2 id=&#34;hvordan-sette-opp-code-scanning&#34;&gt;Hvordan sette opp Code Scanning&lt;/h2&gt;
&lt;p&gt;Code Scanning kan aktiveres ved å gå inn på et &lt;strong&gt;Repository &amp;ndash;&amp;gt; Security &amp;ndash;&amp;gt; Overview &amp;ndash;&amp;gt; Code Scanning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/githubcodescanning.JPG&#34; alt=&#34;Code Scannning&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Deretter må man velge basert på hvilken rammeverk man benytter. Man kan benytte seg av de innebydge arbeidsflyten som er egen basert på definert rammeverk eller man kan bruke CodeQL Analysis&lt;/p&gt;
&lt;h2 id=&#34;github-actions-med-codescanning-med-terraform&#34;&gt;GitHub Actions med CodeScanning med Terraform&lt;/h2&gt;
&lt;p&gt;Med et eksempel her, skal vi vise hvordan man kan bruke Code Scanning sammen med tfsec for å scanne et Github repository som inneholder Terraform kode for å se etter ikke-sikker konfigurasjon.
Code Scanning benytter GitHub Actions, hvor tjenesten vil via en Ubuntu-Worker laste ned innholdet i GitHub repositoriet.  Som et eksempel her har vi laget følgende.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Fork innholdet i repositoriet her &amp;ndash;&amp;gt; &lt;a href=&#34;https://github.com/snyk/terraform-goof&#34;&gt;https://github.com/snyk/terraform-goof&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Gå inn på &lt;strong&gt;Security &amp;ndash;&amp;gt; Overview &amp;ndash;&amp;gt; Code Scanning &amp;ndash;&amp;gt; Velg tfsec fra listen&lt;/strong&gt; klikk Setup this workflow.
&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/tfsec.JPG&#34; alt=&#34;TFSEC&#34;  /&gt;
  Dette vil da lage en Github Actions Workflow i ditt repository som vil kjøres hver gang ny kode sjekkes inn. Konfigurasjon vil du kunne se under ./guthub/workflows mappen.  Du kan se et eksempel på det her &amp;ndash;&amp;gt; (&lt;a href=&#34;https://github.com/trusselsky/terraform-goof&#34;&gt;https://github.com/trusselsky/terraform-goof&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Om du vil sette opp workflow direkte fra lokale IDE og pushe konfigurasjon via Git kan du bruke følgende template.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;name: tfsec

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]  
  schedule:
    - cron: &#39;15 13 * * 5&#39;

jobs:
  tfsec:
    name: Run tfsec sarif report
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
      - name: Clone repo
        uses: actions/checkout@v2

      - name: Run tfsec
        uses: tfsec/tfsec-sarif-action@9a83b5c3524f825c020e356335855741fd02745f
        with:
          sarif_file: tfsec.sarif         

      - name: Upload SARIF file
        uses: github/codeql-action/upload-sarif@v1
        with:
          # Path to SARIF file relative to the root of the repository
          sarif_file: tfsec.sarif  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;NB:&lt;/strong&gt; Tfsec har en del innebygget sjekker mot ulike providere i Terraform, mer informasjon kan finnes her (&lt;a href=&#34;https://tfsec.dev/docs/installation/&#34;&gt;https://tfsec.dev/docs/installation/&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Når flyten er implementert vil den gå igjennom kildekoden å laste opp eventuelle resultat inn i en SARIF fil. Github vil lese innholdet i den genererte SARIF filen for å vise alarmer som kommer frem. Du kan se resultatet under Security &amp;ndash;&amp;gt; Code Scanning Alerts&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/codescanningalerts.JPG&#34; alt=&#34;CodeScanning&#34;  /&gt;
&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Windows 11 og Measured Boot m/TPM</title>
      <link>https://trusselsky.github.io/posts/windows11ogsecureboot/</link>
      <pubDate>Thu, 29 Jul 2021 10:15:54 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/windows11ogsecureboot/</guid>
      <description>&lt;p&gt;Som en del av Windows 11, har Microsoft introdusert en del rekke endringer i forhold til sikkerhet og hardware krav som følger de sikkerhetsfunksjonene.
En av de største endringene er at Microsft nå vil kreve at maskiner som skal kjøre Windows 11 på fysiske maskiner, støtter en funksjon i Windows som heter Measured Boot.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://i0.wp.com/docs.microsoft.com/en-us/windows/security/information-protection/images/dn168167.boot_process%28en-us,msdn.10%29.png?zoom=1.25&amp;amp;w=750&amp;amp;ssl=1&#34; alt=&#34;Secure Boot&#34;  /&gt;
&lt;/p&gt;
&lt;h2 id=&#34;measured-boot&#34;&gt;Measured Boot&lt;/h2&gt;
&lt;p&gt;Measured Boot er delt opp i 2 deler, ene som er Secure Boot prosessen som ble laget for at operativsystemet kun starter opp med programvare som leverandøren kan stole på. Når maskinen starter Secure boot vil den første finne OS Bootloader partisjonen, verifisere at firmwaren er digital signert samt at den ikke er modifisert. Om innholdet er inntakt vil den deretter starte operativsystemet.    Andre delen som kalles Trusted Boot sjekker integriteten av alle Windows baserte komponenter (samt ELAM &amp;ldquo;Early Launch Anti-Malware&amp;rdquo; sjekker at alle drivere er digital signerte før de blir lastet inn i bruker kontekst).&lt;/p&gt;
&lt;p&gt;NB: Secure Boot er en funksjon som ligger i UEFI å ikke noe Microsoft har utviklet.&lt;/p&gt;
&lt;p&gt;For å kunne bruke Measured Boot (m/Secure boot) i Windows krever to ting, det ene er UEFI firmware samt TPM på maskinen.&lt;/p&gt;
&lt;h2 id=&#34;hva-slags-angrep-stopper-denne-tjenesten&#34;&gt;Hva slags angrep stopper denne tjenesten?&lt;/h2&gt;
&lt;p&gt;Selve sikkerhetsmekanismen er beregnet på å stoppe Bootkits og RootKits. Bootkits er skadelig kode som starter før selve operativsystemet laster inn som gjør at om man skulle bli infisert av en Bootkit, kan koden ligge i maskinen og overleve reinnstallasjon av operativsystem blant annet. Trickbot er en malware aktør som benytter seg av Bootkit som de har kalt TrickBoot (Man kan lese mer om det her &amp;ndash;&amp;gt; &lt;a href=&#34;https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/&#34;&gt;https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Samt med ELAM og verifisering av Windows komponenter kan man også unngå Rootkits ved at anti-virus tjenesten kan starte før en eventuelt Rootkit som ofte starter som en prosess eller scheduled task kan starte.&lt;/p&gt;
&lt;p&gt;Selvsagt viktig å påpeke at disse sikkerhetsfunksjonene vil ikke ha noe direkte effekt mot f.eks ransomware angrep, hvor angripere ofte angriper kjørende maskiner ved å utnytte andre sårbarheter. Men dette er rettet mot f.eks mot fysisk angrep hvor noen prøver å modifisere boot prosessen.&lt;/p&gt;
&lt;h2 id=&#34;hvorfor-er-disse-tpm-kravene-her&#34;&gt;Hvorfor er disse TPM kravene her?&lt;/h2&gt;
&lt;p&gt;Så trenger jeg virkelig TPM? å i tilfelle hvilken versjon trenger jeg? Microsoft har endret litt på kravene sine, så for å få lov til å innstallere Windows 11 må man ha støtte for ihvertfall TPM 1.2 eller høyere.&lt;/p&gt;
&lt;p&gt;TPM 1.2 standaren ble ferdig i 2011 så mange av dagens maskiner har&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://pbs.twimg.com/media/E4rU5YiWYAMDqlA?format=png&amp;amp;name=900x900&#34; alt=&#34;Windows 11 krav&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Man kan også slå av denne sjekken under installasjon ved å legge til en enkel registry nøkkel på maskinen.
Ved innstallasjon trykk Shift+F10, åpne registry og legg til nøkkel&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\Setup “BypassTPMCheck”=dword:00000001   
“BypassSecureBootCheck”=dword:00000001
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Microsoft anbefaler at man helst har TPM 2.0 chip på maskinene pga det er en stor løft fra TPM 1.2 til TPM 2.0 &amp;ndash;&amp;gt; (&lt;a href=&#34;https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-recommendations#tpm-12-vs-20-comparison&#34;&gt;https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-recommendations#tpm-12-vs-20-comparison&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&#34;andre-funksjoner-som-vil-kreve-dette&#34;&gt;Andre funksjoner som vil kreve dette&lt;/h2&gt;
&lt;p&gt;Microsoft ønsker også å kunne benytte denne funskjonen som en autentiseringsfaktor også. Mange av tilgangsmekanismene som i dag finnes i Azure AD er basert på enten bruker m/tofator autentisering. Men i bunnen av Windows 11 har Microsoft også utviklet en ny funksjon for utveksling av helse status på maskinen.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://pbs.twimg.com/media/E49JZwLWUAAJWlT?format=jpg&amp;amp;name=large&#34; alt=&#34;Microsoft Azure Attestation&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Som betyr f.eks at Windows 11 maskiner kan sende helse signal til Azure AD ved å gi beskjed om status i forhold til Secure Boot før f.eks en enhet får tilgang til data og tjenester, men dette er noe som kommer på sikt.&lt;/p&gt;
&lt;h2 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h2&gt;
&lt;p&gt;NSA har også laget en god oppsummering på UEFI og Secure Boot prosessen &amp;ndash;&amp;gt; &lt;a href=&#34;https://media.defense.gov/2020/Sep/15/2002497594/-1/-1/0/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF&#34;&gt;https://media.defense.gov/2020/Sep/15/2002497594/-1/-1/0/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF&lt;/a&gt;&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Vanligste sårbarhetene i 2020/2021</title>
      <link>https://trusselsky.github.io/posts/mestutnyttets%C3%A5rbarheter/</link>
      <pubDate>Wed, 28 Jul 2021 15:09:25 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/mestutnyttets%C3%A5rbarheter/</guid>
      <description>&lt;p&gt;U.S. Cybersecurity og Infrastructure Security Agency (CISA) har sammen laget en liste med de (top 30) vanligste sårbarhetene som blir utnyttet i angrep, basert på historiske data fra 2020 (samt sålangt i 2021)&lt;/p&gt;
&lt;p&gt;Du kan se listen over de ulike sårbarheten her &amp;ndash;&amp;gt; &lt;a href=&#34;https://us-cert.cisa.gov/ncas/alerts/aa21-209a&#34;&gt;https://us-cert.cisa.gov/ncas/alerts/aa21-209a&lt;/a&gt; PDF utgave her &amp;ndash;&amp;gt; &lt;a href=&#34;https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf&#34;&gt;https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Sårbarhetene kommer fra en ulike rekke leverandører. Basert på historikk data fra 2020, er følgende de meste utnyttet sårbarhetene:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Citrix - CVE-2019-19781 - arbitrary code execution&lt;/li&gt;
&lt;li&gt;Pulse - CVE 2019-11510 - arbitrary file reading&lt;/li&gt;
&lt;li&gt;Fortinet - CVE 2018-13379 - path traversal&lt;/li&gt;
&lt;li&gt;F5- Big IP - CVE 2020-5902 - remote code execution (RCE)&lt;/li&gt;
&lt;li&gt;MobileIron - CVE 2020-15505 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2017-11882 - RCE&lt;/li&gt;
&lt;li&gt;Atlassian - CVE-2019-11580 - RCE&lt;/li&gt;
&lt;li&gt;Drupal - CVE-2018-7600 - RCE&lt;/li&gt;
&lt;li&gt;Telerik - CVE 2019-18935 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2019-0604 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2020-0787 - elevation of privilege&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2020-1472 - elevation of privilege&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vi så blant annet at Citrix sårbarheten alene kunne påvirke opptil 850 organisasjoner i Norge. Samt blant annet CVE-2021-26855 (Microsoft Exchange) som ble utnyttet mot Stortinget som gjorde det mulig for angripere å hente ut Epost kontoer fra den lokale Exchange databasen ved å kjøre egendefinert kode mot OWA/EXC.&lt;/p&gt;
&lt;p&gt;I 2021 fortsetter angripere å benytte seg av målrettet sårbarheter mot enheter/tjenester som er offentlig tilgjengelig. Blant de som er svært utnyttet så langt i 2021, er sårbarheter i Microsoft, Pulse, Accellion, VMware og Fortinet.&lt;/p&gt;
&lt;p&gt;De har også kompilert en liste over de ulike CVEene med tiltak man kan gjøre for å fikse opp i de ulike sårbarhetene.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>PrintNightmare - CVE-2021-34527</title>
      <link>https://trusselsky.github.io/posts/printnightmare/</link>
      <pubDate>Tue, 27 Jul 2021 16:33:39 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/printnightmare/</guid>
      <description>&lt;h3 id=&#34;hva-er-det&#34;&gt;Hva er det?&lt;/h3&gt;
&lt;p&gt;Den 30 Juli, ble det avdekket en sårbarhet i Print Spooler tjenesten i Windows. Som er en innebygget tjeneste i Windows som håndterer utskrift samt er også ansvarlig for driver innstallasjon knyttet til oppkobling av skrivere på Windows operativsystem.&lt;/p&gt;
&lt;p&gt;Det har kommet en del informasjon knyttet til denne sårbarheten samtidig som den er veldig omfattende og dekkes av flere CVE&amp;rsquo;er.&lt;/p&gt;
&lt;p&gt;1: CVE-2021-1675 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675&lt;/a&gt;) som ikke er sårbarheten dubbet PrintNightmare. Microsoft kom med egen patch for denne med månedlig oppdateringer i Juli.&lt;br&gt;
2: CVE-2021-34527 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527&lt;/a&gt;) har også kommet med egne patcher for de ulike operativsystemene.&lt;br&gt;
3: CVE-2021-34481 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481&lt;/a&gt;) ny sårbarhet for lokal eskalering av tilganger. (Egen artikkel, kom 16 Juli)&lt;/p&gt;
&lt;h3 id=&#34;hvilken-versjoner-gjelder-det&#34;&gt;Hvilken versjoner gjelder det?&lt;/h3&gt;
&lt;p&gt;Denne sårbarheten gjelder alle Windows Operativsystem (både klient og Server) fra Windows 7/2008 til Windows 10/2019.&lt;/p&gt;
&lt;h3 id=&#34;hvilken-konsekvenser-har-det&#34;&gt;Hvilken konsekvenser har det?&lt;/h3&gt;
&lt;p&gt;Denne sårbarheten kan gjøre det mulig å kompromitere maskiner i gitte scenarioer hvor man har Print Spooler tjenesten kjørende. Dette kan da være nettverksbaserte maskiner som domene kontrollere eller andre typer maskiner. Print Spooler tjenesten kjører som standard. Svakheten er definert slik at man kan lage en egendefinert DLL fil (som gjenspeiler en Print Driver) som man kan få print tjenesten i Windows til å importere under SYSTEM kontekst om Remote Printing tjenestne er aktivert. Denne egendefinerte DLL filen kan f.eks inneholde skjulte kommandoer for å tildele f.eks lokal administrator tilgang.  Basert på informasjon vi har tilgjengelig er det ingen aktive angrep som benytter seg av denne angrepsvektoren ennå. Det krever tilgang til f.eks en maskin innenfor domenet for å kunne utnytte seg av sårbarheten som en da autentisert bruker.&lt;/p&gt;
&lt;h3 id=&#34;løsningerworkarounds&#34;&gt;Løsninger/Workarounds&lt;/h3&gt;
&lt;p&gt;Microsoft har kommet med sikkerhetsoppdateringer som løser sårbarheten. Men pga flere sårbarheter som nå blir avdekket i Print Spooler tjenesten, samt generell råd er at man deaktiverer Print Spooler tjenesten på maskiner som ikke har behov for den, som f.eks Domene kontrollere.  Merk at sikkerhetsoppdateringene fra Microsoft krever omstart av maskinene som blir oppdatert.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PowerShell eksempel&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;Stop-Service -Name Spooler -Force
Set-Service -Name Spooler -StartupType Disabled
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Merk at ved å deaktivere Print Spooler tjenesten vil stoppe muligheten for å kjøre print jobber, dette omfatter også f.eks konvertering til PDF. For maskiner hvor man har behov for print som f.eks Citrix servere eller lokale arbeidsstasjoner er det anbefalt at man deaktiverer inbound remote print for å kunne&lt;/p&gt;
&lt;h3 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Eksempler på exploit &lt;a href=&#34;https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527&#34;&gt;https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Her er også et eksempel på hvordan man kan koble opp til en ekstern fiktiv print tjeneste som deretter gir System tilganger på maskinen. Merk at skaperen bak Mimikatz skriver også hvordan man kan begrense dette til kun godkjente systemer også via Group Policy.
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Want to test &lt;a href=&#34;https://twitter.com/hashtag/printnightmare?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#printnightmare&lt;/a&gt; (ep 4.x) user-to-system as a service?🥝&lt;br&gt;(POC only, will write a log file to system32)&lt;br&gt;&lt;br&gt;connect to \\&lt;a href=&#34;https://t.co/6Pk2UnOXaG&#34;&gt;https://t.co/6Pk2UnOXaG&lt;/a&gt; with&lt;br&gt;- user: .\gentilguest&lt;br&gt;- password: password&lt;br&gt;&lt;br&gt;Open &amp;#39;Kiwi Legit Printer - x64&amp;#39;, then &amp;#39;Kiwi Legit Printer - x64 (another one)&amp;#39; &lt;a href=&#34;https://t.co/zHX3aq9PpM&#34;&gt;pic.twitter.com/zHX3aq9PpM&lt;/a&gt;&lt;/p&gt;&amp;mdash; 🥝 Benjamin Delpy (@gentilkiwi) &lt;a href=&#34;https://twitter.com/gentilkiwi/status/1416429860566847490?ref_src=twsrc%5Etfw&#34;&gt;July 17, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description> 
    </item>
    
    <item>
      <title>Serious Sam - CVE-2021-36934</title>
      <link>https://trusselsky.github.io/posts/serioussam/</link>
      <pubDate>Mon, 26 Jul 2021 09:57:04 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/serioussam/</guid>
      <description>&lt;h3 id=&#34;hva-er-det&#34;&gt;Hva er det?&lt;/h3&gt;
&lt;p&gt;Den 19 Juli, ble det avdekket en sårbarhet i SAM (Security Account Manager) databasen i Windows 10 på nyere versjoner. Denne sårbarheten gjorde at brukerdatabasen kunne bli lest av ikke-administrator kontoer i Windows 10 under en gitt kontekst. Dette var kun mulig å gjøre om det fantes VSS (Volume Shadow Service) som oftest brukes for å lage lokale snapshots i Windows (som f.eks Previous Versions). Om man har f.eks backup tjenester som brukes mot Windows 10 klient maskiner vil den ofte bruke VSS for å lage snapshots. Samt f.eks System Restore funksjonen i Windows bruker VSS for å lage snapshosts.&lt;/p&gt;
&lt;p&gt;Sårbarheten ble avdekket av Jonas Lyk (&lt;a href=&#34;https://twitter.com/jonasLyk/status/1417205166172950531&#34;&gt;https://twitter.com/jonasLyk/status/1417205166172950531&lt;/a&gt;)&lt;/p&gt;
&lt;h3 id=&#34;hvilken-versjoner-gjelder-det&#34;&gt;Hvilken versjoner gjelder det?&lt;/h3&gt;
&lt;p&gt;Dette gjelder Windows 10 (fra 1809 oppover) samt Windows Server 2019. Sårbarheten er kun mulig å utnytte om man har tilgang til å kjøre kode på det aktuelle systemet.&lt;/p&gt;
&lt;h3 id=&#34;hvilken-konsekvenser-har-det&#34;&gt;Hvilken konsekvenser har det?&lt;/h3&gt;
&lt;p&gt;Om en klient maskin blir kompromitert samt har shadow copies lokalt på maskinen, kan en angriper bruke dette for å elevere seg selv til å bli lokal administrator. Eller hente ut informasjon om andre brukerkontoer som ligger igjen lokalt, som f.eks domene kontoer.&lt;/p&gt;
&lt;h3 id=&#34;løsningerworkarounds&#34;&gt;Løsninger/Workarounds&lt;/h3&gt;
&lt;p&gt;Microsoft har ikke kommet med patch ennå, men det finnes en workaround for å kunne løse opp i sårbarheten. Samtidig er det viktig å påpeke at sårbarheten ikke blir aktivt utnyttet ennå, men at Microsoft vil komme med en oppdatering fortløpende.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Begrens tilgang til SAM databasen, kjør CMD/PowerShell som Administrator icacls %windir%\system32\config*.* /inheritance:e&lt;/li&gt;
&lt;li&gt;Slett tidligere Shadow Copies som ble laget før punkt 1 ble gjort. Her er mer informasjon knyttet til hvordan finne og slette Shadow Copies &amp;ndash;&amp;gt; &lt;a href=&#34;https://support.microsoft.com/en-gb/topic/kb5005357-delete-volume-shadow-copies-1ceaa637-aaa3-4b58-a48b-baf72a2fa9e7&#34;&gt;https://support.microsoft.com/en-gb/topic/kb5005357-delete-volume-shadow-copies-1ceaa637-aaa3-4b58-a48b-baf72a2fa9e7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Microsoft CVE-2021-36934 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Python PoC (&lt;a href=&#34;https://github.com/GossiTheDog/HiveNightmare&#34;&gt;https://github.com/GossiTheDog/HiveNightmare&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;video-av-exploit&#34;&gt;Video av Exploit&lt;/h3&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/5zdIq6t3DOw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description> 
    </item>
    
  </channel>
</rss>