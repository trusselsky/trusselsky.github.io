<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Trusselsky</title>
    <link>https://trusselsky.github.io/posts/</link>
    <description>Recent content in Posts on Trusselsky</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Tue, 24 Aug 2021 08:16:36 +0200</lastBuildDate>
    
	<atom:link href="https://trusselsky.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>DDoS angrep og trender fremover</title>
      <link>https://trusselsky.github.io/posts/merddos/</link>
      <pubDate>Tue, 24 Aug 2021 08:16:36 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/merddos/</guid>
      <description>&lt;p&gt;Tidligere i sommer stoppet Cloudflare det som er beskrevet som det st√∏rste DDoS angrepet noensinne, med lit over 17.2 millioner foresp√∏rsler-per-sekund over HTTP trafikk (som ofte gj√∏res for √• kamuflere angrepet som mer legitim trafikk). Til sammenligning s√• h√•ndterer Cloudflare som i dag leverer cirka 13% av all HTTP trafikk p√• verdensbasis, ca 25 millioner foresp√∏rsler-per-sekund. Motivet bak √• kj√∏re DDoS angrep er for √• kunne gj√∏re tjenester utilgjengelig eller for √• ta ned infrastruktur med √• overbelaste systemene.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/ddos.jpg&#34; alt=&#34;ddos&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Ofte kj√∏res slike angrep fra kontrollerte Botnet. Som er maskiner som er infisert med malware som igjen blir styrt av en Botnet Operat√∏r for √• kunne utf√∏re DDoS angrep.&lt;/p&gt;
&lt;p&gt;Samtidig kan vi ogs√• se at det skjer flere DDoS mot Norge organisasjoner, som man kan se mer info av her &amp;ndash;&amp;gt; (&lt;a href=&#34;https://radar.cloudflare.com/no&#34;&gt;https://radar.cloudflare.com/no&lt;/a&gt;) som ofte gj√∏res av ulike √•rsaker.&lt;/p&gt;
&lt;p&gt;1: For √• gjennomf√∏re et ransomware angrep (Enten betaler du X antall kroner eller s√• vil din tjeneste v√¶re utilgjengelig) Dette har vi sett ogs√• kan gj√∏res samtidig som hackere gj√∏r angrep via andre vektorer ogs√•. Dette er blant annet noe som ble gjort mot Vinmonopolet i fjor h√∏st &amp;ndash;&amp;gt; &lt;a href=&#34;https://www.digi.no/artikler/hackerne-tok-ned-vinmonopolet-no-i-dag-har-de-varslet-et-mye-verre-angrep/504268&#34;&gt;https://www.digi.no/artikler/hackerne-tok-ned-vinmonopolet-no-i-dag-har-de-varslet-et-mye-verre-angrep/504268&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2: For √• gj√∏re en tjeneste utilgjengelig, enten politisk m√•l eller andre √•rsaker.&lt;/p&gt;
&lt;p&gt;Samtidig vil vi se en trend fremover med flere DDoS angrep. Litt av bakgrunn for dette er fordi at flere applikasjoner og tjenester n√• bytter gradvis over til √• bruke UDP basert transport i stedet for tradisjonelle TCP. Dette da for √• kunne redusere latency √• andre hopp frem og tilbake p√• kommunikasjon samt gi en bedre brukeropplevelse p√• noen tjenester. P√• toppen av UDP er det flere n√• som benytter DTLS som protokoll. DTLS er en protokoll som er hybrid som gir same p√•litelighet som TCP men levert via UDP. Spesielt er det tjenester som Citrix HDX, Microsoft RDP samt Zscaler og noen VPN leverand√∏rer som DTLS som kommunikasjonsprotoll.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/dtls.jpg&#34; alt=&#34;DTLS&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;En grunn til at dette vil gi flere DDoS angrep er pga hvordan de ulike leverand√∏rene har implementert DTLS protokollen. Som en del av standarden er det en attributt som er angitt i standarden som en opsjon (√• er derfor ikke n√∏dvendig). Denne atributten gj√∏r at om noen initierer et angrep mot en tjeneste via DTLS, vil tjeneren svare med en Cookie under (HelloVerifyRequest) for √• forsikre seg om at kommunikasjonen kommer fra en legitim klient, den kommunikasjon blir etablert. For tjenester som ikke har implementert denne attributten p√• tjenester som bruker DTLS vil angripere i visse sammenhenger kunne utnytte dette for et omvendt DDoS angrep.&lt;/p&gt;
&lt;p&gt;De siste √•rene har det v√¶rt en svakhet som har kommet frem b√•de fra Microsoft RDP (via RD Gateway) og Citrix NetScaler ADC (for Citrix sesjoner) du kan ogs√• lese en eldre artikkel her fra Palo Alto om problematikken som var tidligere p√• Microsoft &amp;ndash;&amp;gt; &lt;a href=&#34;https://unit42.paloaltonetworks.com/dtls-vulnerabilities-cve-2014-6321/&#34;&gt;https://unit42.paloaltonetworks.com/dtls-vulnerabilities-cve-2014-6321/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Den andre utfordringen er at mer og mer av vanlig web trafikk beveger seg over til √• bruke HTTP/3 som n√• begynner √• bli ferdig som en standard. Statistikk som man kan se her, s√• er cirka 10% av all trafikk som g√•r mot Norske sider via Cloudflare basert p√• HTTP/3 &amp;ndash;&amp;gt; &lt;a href=&#34;https://radar.cloudflare.com/no&#34;&gt;https://radar.cloudflare.com/no&lt;/a&gt; du kan ogs√• lese mer om HTTP/3 her &amp;ndash;&amp;gt; &lt;a href=&#34;https://trusselsky.no/posts/http3ogfremtiden/&#34;&gt;https://trusselsky.no/posts/http3ogfremtiden/&lt;/a&gt;
Utfordringen ligger i trafikk inspeksjon. Mange av dagens brannmur/sikkerhetstjenester er avhengig av √• kunne inspisere trafikken for √• kunne avdekke angrep eller skadelig innhold. Med HTTP/3 s√• er det ikke mulig √• f√• direkte inspeksjon av innholdet √• derfor vil det v√¶r enklere for angripere √• kunne kamuflere innholdet n√•r de gjennomf√∏rer et angrep. Samtidig s√• legger HTTP/3 mer trykk p√• serveren i form av ressurser for √• h√•ndtere kommunikasjonen, som gj√∏r ogs√• at et DDoS angrep via HTTP/3 vil ikke kreve like mye trafikk for √• kunne ta ned en tjeneste.&lt;/p&gt;
&lt;p&gt;Heldigvis har vi enn√• ikke sett store angrep som har blitt gjort via HTTP/3, men basert p√• trenden vil nok dette ogs√• √∏ke fremover &amp;ndash;&amp;gt; &lt;a href=&#34;https://blog.cloudflare.com/ddos-attack-trends-for-2021-q2/&#34;&gt;https://blog.cloudflare.com/ddos-attack-trends-for-2021-q2/&lt;/a&gt; som man m√• v√¶re varsom til nettverksaktivitet mot eksterne tjenester. Spesielt om man som virksomhet leverer f.eks nettbutikker kan man v√¶re veldig utsatt for slike angrep.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Poly Network hacket, 600 millioner dollar tatt</title>
      <link>https://trusselsky.github.io/posts/polynetworkshack/</link>
      <pubDate>Wed, 11 Aug 2021 00:31:36 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/polynetworkshack/</guid>
      <description>&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/polyhack.JPG&#34; alt=&#34;HTTP3&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Det ble kjent tidligere i dag, at en av de store DeFi platformene Poly Network ble hacket via en svakhet i en mekanisme som kalles for EthCrossChainManager som brukes for validering p√• tvers av ulike blockchain prosjekter. Hvor da angriperne overf√∏rte 610 millioner dollar til 3 ulike addresser fordelt p√• ulik valuta.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$273M Ethereum&lt;/li&gt;
&lt;li&gt;$253M Binance Smart Chain&lt;/li&gt;
&lt;li&gt;$85M Polygon&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Man kan se hele analysen av s√•rbarheten av angrepet her &amp;ndash;&amp;gt;&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Poly has this contract called the &amp;quot;EthCrossChainManager&amp;quot;. It&amp;#39;s basically a privileged contract that has the right to trigger messages from another chain. It&amp;#39;s a pretty standard thing for cross-chain projects.&lt;/p&gt;&amp;mdash; God-like Natural Number Creator Person (TM, R) (@kelvinfichter) &lt;a href=&#34;https://twitter.com/kelvinfichter/status/1425217047898869762?ref_src=twsrc%5Etfw&#34;&gt;August 10, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;N√•r en av de som gjennomf√∏re angrepet skulle pr√∏ve √• overf√∏re med USDT TOKEN, ble han tipset av noen andre at han ikke m√•tte bruke det for da ble han svartlistet. Da fikk vedkommende som tipset dem om det overf√∏rt 13.37 Ether samtidig ogs√• startet en str√∏m av flere folk som √∏nsker at hackeren skal overf√∏re bel√∏p til dem ogs√• (&lt;a href=&#34;https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f&#34;&gt;https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f&lt;/a&gt;) som man ogs√• kan se her at felre ettersp√∏r valuta &amp;ndash;&amp;gt; &lt;a href=&#34;https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963&#34;&gt;https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Klikk videre for √• se hele analysen. Her kan man ogs√• se status knyttet til unders√∏kelsen fra Poly Network selv.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Assets involved include &lt;a href=&#34;https://twitter.com/search?q=%24DAI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$DAI&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24UNI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$UNI&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24SHIB&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$SHIB&lt;/a&gt; &lt;a href=&#34;https://twitter.com/search?q=%24FEI&amp;amp;src=ctag&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;$FEI&lt;/a&gt;.&lt;br&gt;ETH:0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963&lt;br&gt;&lt;br&gt;We call on miners of affected blockchain and crypto exchanges to blacklist tokens coming from the above addresses. &lt;a href=&#34;https://twitter.com/MakerDAO?ref_src=twsrc%5Etfw&#34;&gt;@MakerDAO&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Uniswap?ref_src=twsrc%5Etfw&#34;&gt;@Uniswap&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Shibtoken?ref_src=twsrc%5Etfw&#34;&gt;@Shibtoken&lt;/a&gt; &lt;a href=&#34;https://twitter.com/feiprotocol?ref_src=twsrc%5Etfw&#34;&gt;@feiprotocol&lt;/a&gt;&lt;/p&gt;&amp;mdash; Poly Network (@PolyNetwork2) &lt;a href=&#34;https://twitter.com/PolyNetwork2/status/1425091995911995405?ref_src=twsrc%5Etfw&#34;&gt;August 10, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Noe av valutaen er n√• fryst, mer info f√∏lger.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>ProxyShell - Nye s√•rbarheter mot Exchange</title>
      <link>https://trusselsky.github.io/posts/proxyshellexchange/</link>
      <pubDate>Mon, 09 Aug 2021 16:44:01 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/proxyshellexchange/</guid>
      <description>&lt;p&gt;Under √•rets BlackHat Conference, ble det presentert detaljer rundt nye s√•rbarheter som ble kjent i Microsoft Exchange som n√• har blitt dubbet til &amp;ldquo;ProxyShell&amp;rdquo; som er en kombinasjon av 3 s√•rbarheter.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-34473&lt;/strong&gt; - Pre-auth Path Confusion leads to ACL Bypass (Fikset i April av KB5001779)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-34523&lt;/strong&gt; - Elevation of Privilege on Exchange PowerShell Backend (Fikset i April av KB5001779)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CVE-2021-31207&lt;/strong&gt; - Post-auth Arbitrary-File-Write leads to RCE (Fikset i Oppdatering i Mai av KB5003435)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;S√•rbarhetene kan gj√∏re at uvedkommende kan f√• tilgang til Exchange l√∏sningen √• laste ned epost databaser som da inneholder alt av f.eks epost kontoer (epost, kalender,kontakter osv) siden tilgangen som uvedkommende f√•r ved √• utnytte s√•rbarhetene er lokal system.&lt;/p&gt;
&lt;p&gt;Viktig at man dobbeltsjekker hvilken versjon man er p√• &amp;ndash;&amp;gt; &lt;a href=&#34;https://exchangeserverversions.blogspot.com/2016/01/exchange-server-2016.html&#34;&gt;https://exchangeserverversions.blogspot.com/2016/01/exchange-server-2016.html&lt;/a&gt; (Her er en liste for Exchange 2016)&lt;/p&gt;
&lt;p&gt;MERK: Dette er ikke samme s√•rbarhet som ble utnyttet i angrepet mot Stortinget som ogs√• benyttet en s√•rbarhet mot Exchange, som heter ProxyLogin.&lt;/p&gt;
&lt;p&gt;Disse s√•rbarhetene ble presentert av sikkerhetsforsker Orange Tsai (&lt;a href=&#34;https://twitter.com/orange_8361&#34;&gt;https://twitter.com/orange_8361&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Du kan se presentasjonen her &amp;ndash;&amp;gt; &lt;a href=&#34;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf?fbclid=IwAR2V0-4k2yb8dmPP5Mksd8iHYTOfE6sBwygMt4wjq3M9be8Tw6TlH0andhA&#34;&gt;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf?fbclid=IwAR2V0-4k2yb8dmPP5Mksd8iHYTOfE6sBwygMt4wjq3M9be8Tw6TlH0andhA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Her kan man ogs√• se et video eksempel hvor noen har laget script som utnytter alle s√•rbarhetene for √• kunne ekspotere epost fra Exchange serveren.&lt;/p&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/LbIYPFrltdA&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt;&lt;!-- raw HTML omitted --&gt; Samtidig kan man ogs√• se at bare i Norge er det i overkant av 100+ som har offentlige Exchange servere som fortsatt er s√•rbare.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/proxyshell.jpg&#34; alt=&#34;ProxyLogin&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Samtidig er det flere n√• som merker √∏kt Exchange trafikk, i tillegg er det noen angripere n√• som allerede har begynt √• utnytte s√•rbarhetene.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;My Exchange honeypot has somebody dropping files and executing commands. &lt;a href=&#34;https://t.co/pMVsl7y4iy&#34;&gt;https://t.co/pMVsl7y4iy&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kevin Beaumont (@GossiTheDog) &lt;a href=&#34;https://twitter.com/GossiTheDog/status/1423764613829701632?ref_src=twsrc%5Etfw&#34;&gt;August 6, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;h2 id=&#34;indikatorer&#34;&gt;Indikatorer&lt;/h2&gt;
&lt;p&gt;Flere som scanner n√• etter s√•rbare Exchange servere pr√∏ver √• utnytte s√•rbarheten via Autodiscovery bibloteket p√• CAS serverene.
Et eksempel som har blitt flagget er trafikk mot&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://exchange-server/autodiscover/autodiscover.json?@abc
.com/owa/?&amp;amp;Email=autodiscover/autodiscover.json%3F@abc.com 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Om din Exchange l√∏sning fortsatt er s√•rbar vil den respondere med en HTTP 302 kode tilbake.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>HTTP/3 og fremtidens websikkerhet</title>
      <link>https://trusselsky.github.io/posts/http3ogfremtiden/</link>
      <pubDate>Thu, 05 Aug 2021 21:56:46 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/http3ogfremtiden/</guid>
      <description>&lt;p&gt;Arbeidsgruppen i IETF begynner √• komme i m√•l med HTTP/3 standarden som vil p√•virke b√•de ytelsen og sikkerheten p√• all nett-trafikk, s√• hva er de viktigste endringene √• hvordan p√•virker det ogs√• sikkerheten?&lt;/p&gt;
&lt;h2 id=&#34;historien-s√•-langt&#34;&gt;Historien s√• langt&lt;/h2&gt;
&lt;p&gt;Det skjer for tiden veldig mye utvikling p√• teknologifronten n√•r det gjelder web og hvordan vi kommuniserer med netttjenester.
N√•r man √•pner en nettleser mot f.eks vg.no vil enhenten du sitter p√• benytte en rekke nettverksprotokoller for √• kommunisere med VG sin infrastruktur.&lt;/p&gt;
&lt;p&gt;Protokollen som benyttes i bunn p√• nettleser trafikk er HTTP. HTTP har eksistert lenge og majoriteten av nettlesern trafikken i dag benytter HTTP 1.1 protokollen (som har eksistert siden 90-tallet).
Problemet med den protokollen var (og er) all trafikk blir sendt i klartekst, derfor m√•tte man lage en ny versjon av denne protokollen som her HTTPS som krypterer innholdet mellom tjenester og enhet. Her benyttet man til og begynne med SSL og deretter TLS protokollen som krypteringsprotokoll for √• kryptere innholdet mellom klient og tjener.&lt;/p&gt;
&lt;p&gt;HTTP benytter TCP som kommunikasjonsprotokoll for overf√∏ring av data, som ogs√• gj√∏r den s√•rbar for pakketap eller h√∏y latency. Kombinert med TLS kommunikasjonen f√∏rer til h√∏yere tid mellom klient og tjenester for √• f√• etablert kommunikasjon.&lt;/p&gt;
&lt;p&gt;HTTP 1.1 som protokoll har ogs√• en del svakheter blant annet at den ikke st√∏tter multiplexing p√• en god m√•te som gj√∏r at HTTP trafikk som kommer fra ulike tjenere m√• vente i tur. Samtidig med f.eks HTTP/2 kom de ogs√• med multiplexing som gj√∏r at man ikke f√•r dette problemet. Samtidig introduserte de ogs√• blant annet HPACK (Header Compression) som gj√∏r at man reduserer b√•ndbredden.&lt;/p&gt;
&lt;p&gt;N√•r HTTP/2 standarden kom valgte ogs√• flere leverand√∏rer og kreve at all kommunikasjon som skulle st√∏tte HTTP/2 m√•tte bruke TLS som standard. Som gjorde blant annet f.eks ulike nettlesere som Firefox, Chrome og Edge krever HTTPS n√•r man skal bruke HTTP/2 som protokol.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NB:&lt;/strong&gt; Med TLS 1.3 pr√∏ver man √• redusere tiden det tar √• etablere kommunikasjon mellom klient og tjener ved √• benytte. Her ser man en sammenligning mellom TLS 1.2 over HTTP mot TLS 1.3&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/tls12vs13.jpg&#34; alt=&#34;TLS13&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Samtidig som utviklingen har p√•g√•tt med √• pr√∏ve √• sikre kommunikasjonen (som ogs√• i utgangspunktet har f√∏rt til tregere kommunikasjon og flere forsinkende ledd) har web utviklingen rast videre, hvor vi n√• har mye mer multimedia innhold (bilder,videoer) mye mer 3.parts biblotek og eksterne tjenester. F√∏r var nettleser trafikken mer statisk innhold, hvor det n√• har blitt til mye dynamisk innhold og store rammeverk (CMS) med mer multimedia og streaming mekanismer som gj√∏r at man m√• ha en transport mekanisme som kan overf√∏re data mer effektivt.&lt;/p&gt;
&lt;h2 id=&#34;sikkerhet-og-inspeksjon&#34;&gt;Sikkerhet og inspeksjon&lt;/h2&gt;
&lt;p&gt;Med introduksjon av SSL/TLS krypteringsprotokollene betydde dette at kommunikasjon ble kryptert. (dog dette betyr ikke at innholdet n√∏dvendigvis er trygt)&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;HTTPS &amp;amp; SSL doesn&amp;#39;t mean &amp;quot;trust this.&amp;quot; It means &amp;quot;this is private.&amp;quot; You may be having a private conversation with Satan.&lt;/p&gt;&amp;mdash; Scott Hanselman (@shanselman) &lt;a href=&#34;https://twitter.com/shanselman/status/187572289724887041?ref_src=twsrc%5Etfw&#34;&gt;April 4, 2012&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Med mer ondsinnet trafikk som gikk over nett betydde dette at flere m√•tte begynne √• bruke tjenester for √• kunne analysere innholdet (som i dag tilbys av de fleste brannmur/proxy leverand√∏rer). Dette  kunne da analysere innholdet etter f.eks ondsinnet trafikk eller beskytte brukere fra ukjente adresser eller annet innhold. Flere leverand√∏rer bruker ogs√• lignende mekanismer for √• kunne kategorisere innhold samt definere hvilken applikasjon/tjeneste som en bruker kobler seg opp i mot. Dette betyr i prinsippet at proxy/brannmur tjenesten dekrypterer innholdet for √• kunne &amp;ldquo;se&amp;rdquo; hva som skjer i trafikk str√∏mmen f√∏r trafikken blir kryptert igjen og sendt videre, som en type MiTM (Man-in-the-middle) tjeneste.&lt;/p&gt;
&lt;p&gt;Denne mekanismen ble ogs√• brukt for lastbalanseringstjenester der man kunne balansere trafikk basert p√• spesifikt innhold.&lt;/p&gt;
&lt;h2 id=&#34;hvorfor-http3-&#34;&gt;Hvorfor HTTP/3 ?&lt;/h2&gt;
&lt;p&gt;Allerede n√• er det mange nettsider/leverand√∏rer som har beveget seg videre til HTTP/3, som man ser her s√• er cirka &lt;strong&gt;13% av all kommunikasjon g√•r via HTTP/3 protokollen&lt;/strong&gt; Som store leverand√∏rer som Google, AWS og Cloudflare, mens resten er fordelt p√• HTTP 1.1 og HTTP/2 (Statistikk fra Cloudflare Radar siste 30 dagene) som ogs√• er supportert av de fleste moderne nettlesere.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/http3.jpg&#34; alt=&#34;HTTP/3 Bruk&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Men man ser ogs√• at HTTP/3 har vesentlig forbedret tiden det tar b√•de √• etablere kommunikasjon samt ogs√• hvordan h√•ndtere pakketap.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/http2-http3.png&#34; alt=&#34;HTTP3&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;S√• er forandret i HTTP/3 ?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I stedet for TCP benytter HTTP/3 seg av QUIC (Quick UDP Internet Connections) som overf√∏ringsprotokoll som er bygget p√• UDP. Men samtidig tilbyr flere av TCP egenskapene som p√•litlighet og overbelastingskontroll algoritmer som f.eks CUBIC eller New Reno. (Dette krever dog at UDP/443 er √•pnet i brannmuren)&lt;/li&gt;
&lt;li&gt;Benytter seg QPACK for komprimering av HTTP headere (Sammenlignet med HPACK som ble brukt i HTTP/2)&lt;/li&gt;
&lt;li&gt;Krever TLS kryptering for kommunikasjon (Var ikke et krav i HTTP/2, selv om flere leverand√∏rer krevde det)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Samtidig er ogs√• kryptering som f√∏r har blitt h√•ndtert av TLS n√• gjort direkte i kommunikasjonsprotokollen som gj√∏r at trafikk inspeksjon som f√∏r ble gjort av brannmurer/proxy tjenester ikke lenger er mulig.&lt;/p&gt;
&lt;h2 id=&#34;hvordan-sikre-trafikk-fremover-&#34;&gt;Hvordan sikre trafikk fremover ?&lt;/h2&gt;
&lt;p&gt;Med mer og mer av internett trafikken beveger seg mot bruk av HTTP/3 samtidig som standarden blir ferdigstilt, betyr dette ogs√• at flere organisasjoner m√• ta stilling til hvordan det skal h√•ndtere HTTP/3 trafikken. Flere leverand√∏rer n√• begynner √• komme med st√∏tte for HTTP/3&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Blant annet s√• kommer n√• Microsoft med en ny versjon av SMB som ogs√• st√∏tter QUIC (&lt;a href=&#34;https://techcommunity.microsoft.com/t5/itops-talk-blog/smb-over-quic-files-without-the-vpn/ba-p/1183449&#34;&gt;https://techcommunity.microsoft.com/t5/itops-talk-blog/smb-over-quic-files-without-the-vpn/ba-p/1183449&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Google Cloud st√∏tter QUIC (&lt;a href=&#34;https://cloud.google.com/blog/products/networking/cloud-cdn-and-load-balancing-support-http3&#34;&gt;https://cloud.google.com/blog/products/networking/cloud-cdn-and-load-balancing-support-http3&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Citrix ADC Quic (&lt;a href=&#34;https://docs.citrix.com/en-us/citrix-adc/current-release/system/quic.html&#34;&gt;https://docs.citrix.com/en-us/citrix-adc/current-release/system/quic.html&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Akkurat n√• er det f√• til ingen brannmur/proxy leverand√∏rer som supporterer inspeksjon av QUIC og HTTP/3 og den generelle anbefalingen er √• deaktivere de protokollene i brannmuren, men dette gj√∏r at klientene som sitter p√• innsiden vil falle tilbake til HTTP 1.1 med TLS. Samtidig beveger flere seg p√• utsiden av den tradisjonelle brannmuren ved √• jobbe fra hjemme eller andre lokasjoner, som gj√∏r at den tradisjonelle brannmuren mister litt av den orginale hensikten ved √• beskytte trafikken mellom innsiden og utsiden.&lt;/p&gt;
&lt;p&gt;Derfor vil det v√¶re viktig fremover √• se p√• l√∏sninger som gir mer innsikt direkte fra endepunktet perspektivet for √• kunne ivareta sikkerhet p√• samme m√•te, men samtidig ivareta forbedringene som HTTP/3 kommer med.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Sikring av Kubernetes og tjenester</title>
      <link>https://trusselsky.github.io/posts/sikringavkubernetes/</link>
      <pubDate>Wed, 04 Aug 2021 09:18:38 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/sikringavkubernetes/</guid>
      <description>&lt;p&gt;Flere og flere organisasjoner begynner √• ta i bruk Kubernetes som platform for √• levere fremtidige microtjenester. Kubernetes er ogs√• et veldig komplekst √∏kosystem som kan best√• av mange ulike elementer i forhold til nettverkskontroll, konfigurasjonskontroll og CI/CD blant annet.&lt;/p&gt;
&lt;p&gt;N√•r man skal designe en Kubernetes platform, b√∏r man ha en god forst√•else p√• hvordan man skal sikre l√∏sningen.  Her vil det ligge lenker og oppdatert informasjon p√• referanse arkitektur og best-pratices i forhold til sikring av Kubernetes og tjenester.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://dodcio.defense.gov/Portals/0/Documents/Library/DevSecOpsReferenceDesign.pdf&#34;&gt;DoD DevSecOps: Reference Design&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://media.defense.gov/2021/Aug/03/2002820425/-1/-1/1/CTR_KUBERNETES%20HARDENING%20GUIDANCE.PDF?fbclid=IwAR3wywz7qyCtktUgwXAH95zXcFR3lurRXGzkCoQJNQASc4m_JVZk6WmaqmA&#34;&gt;Kubernetes Hardening Guidance&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description> 
    </item>
    
    <item>
      <title>S√•rbarhetsscanning med GitHub mot kjente rammeverk</title>
      <link>https://trusselsky.github.io/posts/kodescanninggithub/</link>
      <pubDate>Thu, 29 Jul 2021 13:20:04 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/kodescanninggithub/</guid>
      <description>&lt;p&gt;Den (28/07) Annonserte GitHub at som en del av Code Scanning tjenesten de leverer at de n√• har kommet med 15 nye integrasjoner med √•pne kildekode rammeverk som dekker rammeverk som Ruby, PHP, Switch, Terraform, PowerShell og Kubernetes YAML.&lt;/p&gt;
&lt;p&gt;Code Scanning funksjonen ble lansert i 2020 som er tilgjengelig for alle offentelige repositories samt for Private repositories (Krever GitHub Advanced) men gj√∏r at man kan se igjennom kildekoden etter s√•rbarheter.&lt;/p&gt;
&lt;h2 id=&#34;hvordan-sette-opp-code-scanning&#34;&gt;Hvordan sette opp Code Scanning&lt;/h2&gt;
&lt;p&gt;Code Scanning kan aktiveres ved √• g√• inn p√• et &lt;strong&gt;Repository &amp;ndash;&amp;gt; Security &amp;ndash;&amp;gt; Overview &amp;ndash;&amp;gt; Code Scanning&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/githubcodescanning.JPG&#34; alt=&#34;Code Scannning&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Deretter m√• man velge basert p√• hvilken rammeverk man benytter. Man kan benytte seg av de innebydge arbeidsflyten som er egen basert p√• definert rammeverk eller man kan bruke CodeQL Analysis&lt;/p&gt;
&lt;h2 id=&#34;github-actions-med-codescanning-med-terraform&#34;&gt;GitHub Actions med CodeScanning med Terraform&lt;/h2&gt;
&lt;p&gt;Med et eksempel her, skal vi vise hvordan man kan bruke Code Scanning sammen med tfsec for √• scanne et Github repository som inneholder Terraform kode for √• se etter ikke-sikker konfigurasjon.
Code Scanning benytter GitHub Actions, hvor tjenesten vil via en Ubuntu-Worker laste ned innholdet i GitHub repositoriet.  Som et eksempel her har vi laget f√∏lgende.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Fork innholdet i repositoriet her &amp;ndash;&amp;gt; &lt;a href=&#34;https://github.com/snyk/terraform-goof&#34;&gt;https://github.com/snyk/terraform-goof&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;G√• inn p√• &lt;strong&gt;Security &amp;ndash;&amp;gt; Overview &amp;ndash;&amp;gt; Code Scanning &amp;ndash;&amp;gt; Velg tfsec fra listen&lt;/strong&gt; klikk Setup this workflow.
&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/tfsec.JPG&#34; alt=&#34;TFSEC&#34;  /&gt;
  Dette vil da lage en Github Actions Workflow i ditt repository som vil kj√∏res hver gang ny kode sjekkes inn. Konfigurasjon vil du kunne se under ./guthub/workflows mappen.  Du kan se et eksempel p√• det her &amp;ndash;&amp;gt; (&lt;a href=&#34;https://github.com/trusselsky/terraform-goof&#34;&gt;https://github.com/trusselsky/terraform-goof&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Om du vil sette opp workflow direkte fra lokale IDE og pushe konfigurasjon via Git kan du bruke f√∏lgende template.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;name: tfsec

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]  
  schedule:
    - cron: &#39;15 13 * * 5&#39;

jobs:
  tfsec:
    name: Run tfsec sarif report
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
      - name: Clone repo
        uses: actions/checkout@v2

      - name: Run tfsec
        uses: tfsec/tfsec-sarif-action@9a83b5c3524f825c020e356335855741fd02745f
        with:
          sarif_file: tfsec.sarif         

      - name: Upload SARIF file
        uses: github/codeql-action/upload-sarif@v1
        with:
          # Path to SARIF file relative to the root of the repository
          sarif_file: tfsec.sarif  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;NB:&lt;/strong&gt; Tfsec har en del innebygget sjekker mot ulike providere i Terraform, mer informasjon kan finnes her (&lt;a href=&#34;https://tfsec.dev/docs/installation/&#34;&gt;https://tfsec.dev/docs/installation/&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;N√•r flyten er implementert vil den g√• igjennom kildekoden √• laste opp eventuelle resultat inn i en SARIF fil. Github vil lese innholdet i den genererte SARIF filen for √• vise alarmer som kommer frem. Du kan se resultatet under Security &amp;ndash;&amp;gt; Code Scanning Alerts&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://trusselsky.github.io/codescanningalerts.JPG&#34; alt=&#34;CodeScanning&#34;  /&gt;
&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Windows 11 og Measured Boot m/TPM</title>
      <link>https://trusselsky.github.io/posts/windows11ogsecureboot/</link>
      <pubDate>Thu, 29 Jul 2021 10:15:54 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/windows11ogsecureboot/</guid>
      <description>&lt;p&gt;Som en del av Windows 11, har Microsoft introdusert en del rekke endringer i forhold til sikkerhet og hardware krav som f√∏lger de sikkerhetsfunksjonene.
En av de st√∏rste endringene er at Microsft n√• vil kreve at maskiner som skal kj√∏re Windows 11 p√• fysiske maskiner, st√∏tter en funksjon i Windows som heter Measured Boot.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://i0.wp.com/docs.microsoft.com/en-us/windows/security/information-protection/images/dn168167.boot_process%28en-us,msdn.10%29.png?zoom=1.25&amp;amp;w=750&amp;amp;ssl=1&#34; alt=&#34;Secure Boot&#34;  /&gt;
&lt;/p&gt;
&lt;h2 id=&#34;measured-boot&#34;&gt;Measured Boot&lt;/h2&gt;
&lt;p&gt;Measured Boot er delt opp i 2 deler, ene som er Secure Boot prosessen som ble laget for at operativsystemet kun starter opp med programvare som leverand√∏ren kan stole p√•. N√•r maskinen starter Secure boot vil den f√∏rste finne OS Bootloader partisjonen, verifisere at firmwaren er digital signert samt at den ikke er modifisert. Om innholdet er inntakt vil den deretter starte operativsystemet.    Andre delen som kalles Trusted Boot sjekker integriteten av alle Windows baserte komponenter (samt ELAM &amp;ldquo;Early Launch Anti-Malware&amp;rdquo; sjekker at alle drivere er digital signerte f√∏r de blir lastet inn i bruker kontekst).&lt;/p&gt;
&lt;p&gt;NB: Secure Boot er en funksjon som ligger i UEFI √• ikke noe Microsoft har utviklet.&lt;/p&gt;
&lt;p&gt;For √• kunne bruke Measured Boot (m/Secure boot) i Windows krever to ting, det ene er UEFI firmware samt TPM p√• maskinen.&lt;/p&gt;
&lt;h2 id=&#34;hva-slags-angrep-stopper-denne-tjenesten&#34;&gt;Hva slags angrep stopper denne tjenesten?&lt;/h2&gt;
&lt;p&gt;Selve sikkerhetsmekanismen er beregnet p√• √• stoppe Bootkits og RootKits. Bootkits er skadelig kode som starter f√∏r selve operativsystemet laster inn som gj√∏r at om man skulle bli infisert av en Bootkit, kan koden ligge i maskinen og overleve reinnstallasjon av operativsystem blant annet. Trickbot er en malware akt√∏r som benytter seg av Bootkit som de har kalt TrickBoot (Man kan lese mer om det her &amp;ndash;&amp;gt; &lt;a href=&#34;https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/&#34;&gt;https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Samt med ELAM og verifisering av Windows komponenter kan man ogs√• unng√• Rootkits ved at anti-virus tjenesten kan starte f√∏r en eventuelt Rootkit som ofte starter som en prosess eller scheduled task kan starte.&lt;/p&gt;
&lt;p&gt;Selvsagt viktig √• p√•peke at disse sikkerhetsfunksjonene vil ikke ha noe direkte effekt mot f.eks ransomware angrep, hvor angripere ofte angriper kj√∏rende maskiner ved √• utnytte andre s√•rbarheter. Men dette er rettet mot f.eks mot fysisk angrep hvor noen pr√∏ver √• modifisere boot prosessen.&lt;/p&gt;
&lt;h2 id=&#34;hvorfor-er-disse-tpm-kravene-her&#34;&gt;Hvorfor er disse TPM kravene her?&lt;/h2&gt;
&lt;p&gt;S√• trenger jeg virkelig TPM? √• i tilfelle hvilken versjon trenger jeg? Microsoft har endret litt p√• kravene sine, s√• for √• f√• lov til √• innstallere Windows 11 m√• man ha st√∏tte for ihvertfall TPM 1.2 eller h√∏yere.&lt;/p&gt;
&lt;p&gt;TPM 1.2 standaren ble ferdig i 2011 s√• mange av dagens maskiner har&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://pbs.twimg.com/media/E4rU5YiWYAMDqlA?format=png&amp;amp;name=900x900&#34; alt=&#34;Windows 11 krav&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Man kan ogs√• sl√• av denne sjekken under installasjon ved √• legge til en enkel registry n√∏kkel p√• maskinen.
Ved innstallasjon trykk Shift+F10, √•pne registry og legg til n√∏kkel&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\Setup ‚ÄúBypassTPMCheck‚Äù=dword:00000001   
‚ÄúBypassSecureBootCheck‚Äù=dword:00000001
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Microsoft anbefaler at man helst har TPM 2.0 chip p√• maskinene pga det er en stor l√∏ft fra TPM 1.2 til TPM 2.0 &amp;ndash;&amp;gt; (&lt;a href=&#34;https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-recommendations#tpm-12-vs-20-comparison&#34;&gt;https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-recommendations#tpm-12-vs-20-comparison&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&#34;andre-funksjoner-som-vil-kreve-dette&#34;&gt;Andre funksjoner som vil kreve dette&lt;/h2&gt;
&lt;p&gt;Microsoft √∏nsker ogs√• √• kunne benytte denne funskjonen som en autentiseringsfaktor ogs√•. Mange av tilgangsmekanismene som i dag finnes i Azure AD er basert p√• enten bruker m/tofator autentisering. Men i bunnen av Windows 11 har Microsoft ogs√• utviklet en ny funksjon for utveksling av helse status p√• maskinen.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://pbs.twimg.com/media/E49JZwLWUAAJWlT?format=jpg&amp;amp;name=large&#34; alt=&#34;Microsoft Azure Attestation&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Som betyr f.eks at Windows 11 maskiner kan sende helse signal til Azure AD ved √• gi beskjed om status i forhold til Secure Boot f√∏r f.eks en enhet f√•r tilgang til data og tjenester, men dette er noe som kommer p√• sikt.&lt;/p&gt;
&lt;h2 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h2&gt;
&lt;p&gt;NSA har ogs√• laget en god oppsummering p√• UEFI og Secure Boot prosessen &amp;ndash;&amp;gt; &lt;a href=&#34;https://media.defense.gov/2020/Sep/15/2002497594/-1/-1/0/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF&#34;&gt;https://media.defense.gov/2020/Sep/15/2002497594/-1/-1/0/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF/CTR-UEFI-SECURE-BOOT-CUSTOMIZATION-20200915.PDF&lt;/a&gt;&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>Vanligste s√•rbarhetene i 2020/2021</title>
      <link>https://trusselsky.github.io/posts/mestutnyttets%C3%A5rbarheter/</link>
      <pubDate>Wed, 28 Jul 2021 15:09:25 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/mestutnyttets%C3%A5rbarheter/</guid>
      <description>&lt;p&gt;U.S. Cybersecurity og Infrastructure Security Agency (CISA) har sammen laget en liste med de (top 30) vanligste s√•rbarhetene som blir utnyttet i angrep, basert p√• historiske data fra 2020 (samt s√•langt i 2021)&lt;/p&gt;
&lt;p&gt;Du kan se listen over de ulike s√•rbarheten her &amp;ndash;&amp;gt; &lt;a href=&#34;https://us-cert.cisa.gov/ncas/alerts/aa21-209a&#34;&gt;https://us-cert.cisa.gov/ncas/alerts/aa21-209a&lt;/a&gt; PDF utgave her &amp;ndash;&amp;gt; &lt;a href=&#34;https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf&#34;&gt;https://us-cert.cisa.gov/sites/default/files/publications/AA21-209A_Joint%20CSA_Top%20Routinely%20Exploited%20Vulnerabilities.pdf&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;S√•rbarhetene kommer fra en ulike rekke leverand√∏rer. Basert p√• historikk data fra 2020, er f√∏lgende de meste utnyttet s√•rbarhetene:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Citrix - CVE-2019-19781 - arbitrary code execution&lt;/li&gt;
&lt;li&gt;Pulse - CVE 2019-11510 - arbitrary file reading&lt;/li&gt;
&lt;li&gt;Fortinet - CVE 2018-13379 - path traversal&lt;/li&gt;
&lt;li&gt;F5- Big IP - CVE 2020-5902 - remote code execution (RCE)&lt;/li&gt;
&lt;li&gt;MobileIron - CVE 2020-15505 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2017-11882 - RCE&lt;/li&gt;
&lt;li&gt;Atlassian - CVE-2019-11580 - RCE&lt;/li&gt;
&lt;li&gt;Drupal - CVE-2018-7600 - RCE&lt;/li&gt;
&lt;li&gt;Telerik - CVE 2019-18935 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2019-0604 - RCE&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2020-0787 - elevation of privilege&lt;/li&gt;
&lt;li&gt;Microsoft - CVE-2020-1472 - elevation of privilege&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vi s√• blant annet at Citrix s√•rbarheten alene kunne p√•virke opptil 850 organisasjoner i Norge. Samt blant annet CVE-2021-26855 (Microsoft Exchange) som ble utnyttet mot Stortinget som gjorde det mulig for angripere √• hente ut Epost kontoer fra den lokale Exchange databasen ved √• kj√∏re egendefinert kode mot OWA/EXC.&lt;/p&gt;
&lt;p&gt;I 2021 fortsetter angripere √• benytte seg av m√•lrettet s√•rbarheter mot enheter/tjenester som er offentlig tilgjengelig. Blant de som er sv√¶rt utnyttet s√• langt i 2021, er s√•rbarheter i Microsoft, Pulse, Accellion, VMware og Fortinet.&lt;/p&gt;
&lt;p&gt;De har ogs√• kompilert en liste over de ulike CVEene med tiltak man kan gj√∏re for √• fikse opp i de ulike s√•rbarhetene.&lt;/p&gt;
</description> 
    </item>
    
    <item>
      <title>PrintNightmare - CVE-2021-34527</title>
      <link>https://trusselsky.github.io/posts/printnightmare/</link>
      <pubDate>Tue, 27 Jul 2021 16:33:39 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/printnightmare/</guid>
      <description>&lt;h3 id=&#34;hva-er-det&#34;&gt;Hva er det?&lt;/h3&gt;
&lt;p&gt;Den 30 Juli, ble det avdekket en s√•rbarhet i Print Spooler tjenesten i Windows. Som er en innebygget tjeneste i Windows som h√•ndterer utskrift samt er ogs√• ansvarlig for driver innstallasjon knyttet til oppkobling av skrivere p√• Windows operativsystem.&lt;/p&gt;
&lt;p&gt;Det har kommet en del informasjon knyttet til denne s√•rbarheten samtidig som den er veldig omfattende og dekkes av flere CVE&amp;rsquo;er.&lt;/p&gt;
&lt;p&gt;1: CVE-2021-1675 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675&lt;/a&gt;) som ikke er s√•rbarheten dubbet PrintNightmare. Microsoft kom med egen patch for denne med m√•nedlig oppdateringer i Juli.&lt;br&gt;
2: CVE-2021-34527 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527&lt;/a&gt;) har ogs√• kommet med egne patcher for de ulike operativsystemene.&lt;br&gt;
3: CVE-2021-34481 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481&lt;/a&gt;) ny s√•rbarhet for lokal eskalering av tilganger. (Egen artikkel, kom 16 Juli)&lt;/p&gt;
&lt;h3 id=&#34;hvilken-versjoner-gjelder-det&#34;&gt;Hvilken versjoner gjelder det?&lt;/h3&gt;
&lt;p&gt;Denne s√•rbarheten gjelder alle Windows Operativsystem (b√•de klient og Server) fra Windows 7/2008 til Windows 10/2019.&lt;/p&gt;
&lt;h3 id=&#34;hvilken-konsekvenser-har-det&#34;&gt;Hvilken konsekvenser har det?&lt;/h3&gt;
&lt;p&gt;Denne s√•rbarheten kan gj√∏re det mulig √• kompromitere maskiner i gitte scenarioer hvor man har Print Spooler tjenesten kj√∏rende. Dette kan da v√¶re nettverksbaserte maskiner som domene kontrollere eller andre typer maskiner. Print Spooler tjenesten kj√∏rer som standard. Svakheten er definert slik at man kan lage en egendefinert DLL fil (som gjenspeiler en Print Driver) som man kan f√• print tjenesten i Windows til √• importere under SYSTEM kontekst om Remote Printing tjenestne er aktivert. Denne egendefinerte DLL filen kan f.eks inneholde skjulte kommandoer for √• tildele f.eks lokal administrator tilgang.  Basert p√• informasjon vi har tilgjengelig er det ingen aktive angrep som benytter seg av denne angrepsvektoren enn√•. Det krever tilgang til f.eks en maskin innenfor domenet for √• kunne utnytte seg av s√•rbarheten som en da autentisert bruker.&lt;/p&gt;
&lt;h3 id=&#34;l√∏sningerworkarounds&#34;&gt;L√∏sninger/Workarounds&lt;/h3&gt;
&lt;p&gt;Microsoft har kommet med sikkerhetsoppdateringer som l√∏ser s√•rbarheten. Men pga flere s√•rbarheter som n√• blir avdekket i Print Spooler tjenesten, samt generell r√•d er at man deaktiverer Print Spooler tjenesten p√• maskiner som ikke har behov for den, som f.eks Domene kontrollere.  Merk at sikkerhetsoppdateringene fra Microsoft krever omstart av maskinene som blir oppdatert.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PowerShell eksempel&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;Stop-Service -Name Spooler -Force
Set-Service -Name Spooler -StartupType Disabled
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Merk at ved √• deaktivere Print Spooler tjenesten vil stoppe muligheten for √• kj√∏re print jobber, dette omfatter ogs√• f.eks konvertering til PDF. For maskiner hvor man har behov for print som f.eks Citrix servere eller lokale arbeidsstasjoner er det anbefalt at man deaktiverer inbound remote print for √• kunne&lt;/p&gt;
&lt;h3 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Eksempler p√• exploit &lt;a href=&#34;https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527&#34;&gt;https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Her er ogs√• et eksempel p√• hvordan man kan koble opp til en ekstern fiktiv print tjeneste som deretter gir System tilganger p√• maskinen. Merk at skaperen bak Mimikatz skriver ogs√• hvordan man kan begrense dette til kun godkjente systemer ogs√• via Group Policy.
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Want to test &lt;a href=&#34;https://twitter.com/hashtag/printnightmare?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#printnightmare&lt;/a&gt; (ep 4.x) user-to-system as a service?ü•ù&lt;br&gt;(POC only, will write a log file to system32)&lt;br&gt;&lt;br&gt;connect to \\&lt;a href=&#34;https://t.co/6Pk2UnOXaG&#34;&gt;https://t.co/6Pk2UnOXaG&lt;/a&gt; with&lt;br&gt;- user: .\gentilguest&lt;br&gt;- password: password&lt;br&gt;&lt;br&gt;Open &amp;#39;Kiwi Legit Printer - x64&amp;#39;, then &amp;#39;Kiwi Legit Printer - x64 (another one)&amp;#39; &lt;a href=&#34;https://t.co/zHX3aq9PpM&#34;&gt;pic.twitter.com/zHX3aq9PpM&lt;/a&gt;&lt;/p&gt;&amp;mdash; ü•ù Benjamin Delpy (@gentilkiwi) &lt;a href=&#34;https://twitter.com/gentilkiwi/status/1416429860566847490?ref_src=twsrc%5Etfw&#34;&gt;July 17, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description> 
    </item>
    
    <item>
      <title>Serious Sam - CVE-2021-36934</title>
      <link>https://trusselsky.github.io/posts/serioussam/</link>
      <pubDate>Mon, 26 Jul 2021 09:57:04 +0200</pubDate>
      
      <guid>https://trusselsky.github.io/posts/serioussam/</guid>
      <description>&lt;h3 id=&#34;hva-er-det&#34;&gt;Hva er det?&lt;/h3&gt;
&lt;p&gt;Den 19 Juli, ble det avdekket en s√•rbarhet i SAM (Security Account Manager) databasen i Windows 10 p√• nyere versjoner. Denne s√•rbarheten gjorde at brukerdatabasen kunne bli lest av ikke-administrator kontoer i Windows 10 under en gitt kontekst. Dette var kun mulig √• gj√∏re om det fantes VSS (Volume Shadow Service) som oftest brukes for √• lage lokale snapshots i Windows (som f.eks Previous Versions). Om man har f.eks backup tjenester som brukes mot Windows 10 klient maskiner vil den ofte bruke VSS for √• lage snapshots. Samt f.eks System Restore funksjonen i Windows bruker VSS for √• lage snapshosts.&lt;/p&gt;
&lt;p&gt;S√•rbarheten ble avdekket av Jonas Lyk (&lt;a href=&#34;https://twitter.com/jonasLyk/status/1417205166172950531&#34;&gt;https://twitter.com/jonasLyk/status/1417205166172950531&lt;/a&gt;)&lt;/p&gt;
&lt;h3 id=&#34;hvilken-versjoner-gjelder-det&#34;&gt;Hvilken versjoner gjelder det?&lt;/h3&gt;
&lt;p&gt;Dette gjelder Windows 10 (fra 1809 oppover) samt Windows Server 2019. S√•rbarheten er kun mulig √• utnytte om man har tilgang til √• kj√∏re kode p√• det aktuelle systemet.&lt;/p&gt;
&lt;h3 id=&#34;hvilken-konsekvenser-har-det&#34;&gt;Hvilken konsekvenser har det?&lt;/h3&gt;
&lt;p&gt;Om en klient maskin blir kompromitert samt har shadow copies lokalt p√• maskinen, kan en angriper bruke dette for √• elevere seg selv til √• bli lokal administrator. Eller hente ut informasjon om andre brukerkontoer som ligger igjen lokalt, som f.eks domene kontoer.&lt;/p&gt;
&lt;h3 id=&#34;l√∏sningerworkarounds&#34;&gt;L√∏sninger/Workarounds&lt;/h3&gt;
&lt;p&gt;Microsoft har ikke kommet med patch enn√•, men det finnes en workaround for √• kunne l√∏se opp i s√•rbarheten. Samtidig er det viktig √• p√•peke at s√•rbarheten ikke blir aktivt utnyttet enn√•, men at Microsoft vil komme med en oppdatering fortl√∏pende.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Begrens tilgang til SAM databasen, kj√∏r CMD/PowerShell som Administrator icacls %windir%\system32\config*.* /inheritance:e&lt;/li&gt;
&lt;li&gt;Slett tidligere Shadow Copies som ble laget f√∏r punkt 1 ble gjort. Her er mer informasjon knyttet til hvordan finne og slette Shadow Copies &amp;ndash;&amp;gt; &lt;a href=&#34;https://support.microsoft.com/en-gb/topic/kb5005357-delete-volume-shadow-copies-1ceaa637-aaa3-4b58-a48b-baf72a2fa9e7&#34;&gt;https://support.microsoft.com/en-gb/topic/kb5005357-delete-volume-shadow-copies-1ceaa637-aaa3-4b58-a48b-baf72a2fa9e7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mer-informasjon&#34;&gt;Mer informasjon&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Microsoft CVE-2021-36934 (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934&#34;&gt;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Python PoC (&lt;a href=&#34;https://github.com/GossiTheDog/HiveNightmare&#34;&gt;https://github.com/GossiTheDog/HiveNightmare&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;video-av-exploit&#34;&gt;Video av Exploit&lt;/h3&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/5zdIq6t3DOw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description> 
    </item>
    
  </channel>
</rss>